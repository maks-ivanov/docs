---
title: "get_test.go"
---

## High-level description
This file contains a unit test for the `Manager.GetContext` method in the `repos` package. The test verifies that the method correctly sets up a runtime environment for a Python tool, including the working directory and environment variables.

## Code Structure
The test file defines a single test function `TestManager_GetContext` that creates a `Manager` instance, calls the `GetContext` method with a sample tool configuration, and asserts the expected outcomes.

## Symbols

### `TestManager_GetContext`
#### Description
This function tests the `GetContext` method of the `Manager` struct. It sets up a test environment, calls the method with a sample tool configuration, and verifies the results.

#### Inputs
N/A (Test function)

#### Outputs
N/A (Test function)

#### Internal Logic
1. Creates a new `Manager` instance with a test cache home directory and a Python 3.11 runtime.
2. Calls `GetContext` with a context, a sample tool configuration (pointing to a GitHub repository), and environment settings.
3. Asserts that the method returns without error.
4. Checks that the returned working directory is not empty.
5. Verifies that the returned environment variables list is not empty.
6. Prints the working directory and environment variables for debugging purposes.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| context | Provides context for the test |
| fmt | Used for printing debug information |
| os | Accessing environment variables |
| testing | Go's testing framework |
| github.com/adrg/xdg | Handling XDG Base Directory Specification |
| github.com/gptscript-ai/gptscript/pkg/repos/runtimes/python | Python runtime implementation |
| github.com/gptscript-ai/gptscript/pkg/types | Custom types used in the project |
| github.com/samber/lo | Utility functions (used for error handling) |
| github.com/stretchr/testify/assert | Assertion functions for testing |
| github.com/stretchr/testify/require | Required assertion functions for testing |

## Configuration
The test uses a constant `testCacheHome` to define the cache directory for the test:
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| testCacheHome | string | (dynamically set) | The cache directory used for the test |

## Notes
- The test is specifically set up for a Python 3.11 runtime.
- The test uses a specific GitHub repository (dalle-image-generation) and commit hash for the tool configuration.
- The test prints the working directory and environment variables, which can be useful for debugging but might clutter test output in a CI/CD environment.