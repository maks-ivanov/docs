---
title: "pvc.yaml"
---

## High-level description
This code defines a Kubernetes PersistentVolumeClaim (PVC) template using Helm templating. It dynamically sets the storage size based on the environment and uses a specific storage class for AWS environments.

## Table of contents
- Metadata
- Spec
    - accessModes
    - storageClassName
    - resources

## Symbols
### `pvc.yaml`
#### Description
This code defines a Kubernetes PersistentVolumeClaim (PVC) template. It specifies the access modes, storage class, and storage size for the volume. The template uses Helm variables and conditional logic to customize the PVC based on the deployment environment.

#### Inputs
This template uses values from a Helm values file, likely `values.yaml`. The relevant values are:

| Name | Type | Description |
|:-----|:-----|:------------|
| `.Values.environment` | string | The deployment environment (e.g., "aws", "local"). |
| `.Release.Name` | string | The name of the Helm release. |
| `$NAME` | string | The name of the application. |

#### Outputs
A Kubernetes PersistentVolumeClaim object.

#### Internal Logic
1. **Storage Size:** The `storage` value is dynamically set based on the `environment`:
    - If `environment` is "local", `storage` is set to "500Gi".
    - Otherwise, `storage` defaults to "10Gi".
2. **Storage Class:**
    - If `environment` is "aws", the `storageClassName` is set to "gp2".
    - Otherwise, `storageClassName` is set to an empty string, which typically means the default storage class will be used.

## Dependencies
This code depends on Kubernetes and Helm.

## Configuration
Configuration is managed through a Helm values file. The following options are available:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| `environment` | string | N/A | The deployment environment. |

## Future Improvements
- Consider adding validation for the `environment` value to prevent unexpected behavior.
- For more complex scenarios, explore using Helm functions for more sophisticated logic in determining storage size and class. 
