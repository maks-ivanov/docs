---
title: "test_polars_table.py"
---

## High-level description

The target file `test_polars_table.py` is a unit test suite for the `PolarsTableManagerFactory` and its associated `PolarsTableManager` class, which are part of a plugin system for managing and manipulating data tables using the Polars library. The tests cover various functionalities such as data conversion to CSV and JSON, data selection, sorting, summarization, and formatting, ensuring that the `PolarsTableManager` behaves as expected when handling complex data types and operations.

## Code Structure

- **TestPolarsTableManagerFactory**: A test class that uses the `unittest` framework to define and run tests for the `PolarsTableManagerFactory` and `PolarsTableManager`.
- **PolarsTableManagerFactory**: A factory class responsible for creating instances of `PolarsTableManager`.
- **PolarsTableManager**: A class that extends `TableManager` to provide specific implementations for handling Polars DataFrames.

## References

- **ColumnSummary**: A data model used to represent summaries of data columns.
- **DependencyManager**: Manages optional dependencies, such as checking if the Polars library is installed.
- **snapshotter**: A utility function for creating and comparing snapshots of test results.

## Symbols

### `TestPolarsTableManagerFactory`
#### Description
This class contains unit tests for the `PolarsTableManagerFactory` and `PolarsTableManager`. It verifies the functionality of data manipulation methods such as conversion to CSV/JSON, row/column selection, sorting, and data summarization.

#### Inputs
- None directly, but it uses Polars DataFrames created within the test methods.

#### Outputs
- None directly, but it asserts expected outcomes for various operations.

#### Internal Logic
- **setUp**: Initializes a `PolarsTableManager` instance with a sample DataFrame for use in tests.
- **get_complex_data**: Creates a complex Polars DataFrame with various data types for testing.
- **test_package_name**: Verifies that the package name is correctly identified as "polars".
- **test_to_csv**: Tests conversion of data to CSV format and verifies the output.
- **test_to_json**: Tests conversion of data to JSON format and verifies the output.
- **test_complex_data_field_types**: Checks the field types of complex data.
- **test_select_rows**: Tests row selection functionality.
- **test_select_columns**: Tests column selection functionality.
- **test_get_row_headers**: Verifies that row headers are correctly retrieved.
- **test_is_type**: Checks if the data is correctly identified as a Polars DataFrame.
- **test_get_field_types**: Verifies the field types of the data.
- **test_limit**: Tests limiting the number of rows in the data.
- **test_summary_* methods**: Test the summarization of different data types (integer, string, number, boolean, date).
- **test_sort_values**: Tests sorting of data by a specified column.
- **test_get_unique_column_values**: Verifies retrieval of unique values from a column.
- **test_search**: Tests searching within the data.
- **test_apply_formatting_* methods**: Test the application of formatting functions to the data, ensuring original data is not modified and formatting is applied correctly.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `pytest` | Used for marking tests to be skipped if dependencies are not installed. |
| `unittest` | Provides the framework for defining and running the test cases. |
| `polars` | The library being tested for data manipulation capabilities. |
| `numpy` | Used in tests for creating arrays within DataFrames. |

## Error Handling

- The tests use assertions to verify expected outcomes. If an assertion fails, it indicates a discrepancy between the expected and actual behavior of the `PolarsTableManager`.

## Logging

- The `snapshotter` utility is used to log and compare test outputs with expected snapshots, updating them if differences are found.

## TODOs

- There are no explicit TODOs in the code, but the commented-out section regarding time data types suggests potential future work to handle these cases.