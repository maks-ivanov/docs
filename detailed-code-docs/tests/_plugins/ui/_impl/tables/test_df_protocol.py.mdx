---
title: "test_df_protocol.py"
---

## High-level description

The target file `test_df_protocol.py` contains unit tests for the `DataFrameProtocolTableManager` class, which is part of a larger system for managing and manipulating data tables using a DataFrame-like protocol. The tests verify the functionality of various methods in the `DataFrameProtocolTableManager`, such as converting data to CSV or JSON, selecting rows or columns, and applying formatting to data.

## Code Structure

The main symbol in this file is the `TestDataFrameProtocolTableManager` class, which is a test suite for the `DataFrameProtocolTableManager`. This class contains multiple test methods, each designed to test a specific functionality of the `DataFrameProtocolTableManager`. The tests are executed using the `unittest` framework, and they are conditionally skipped if certain dependencies are not installed.

## References

- `DataFrameProtocolTableManager`: The class being tested, which is defined in `marimo._plugins.ui._impl.tables.df_protocol_table`.
- `ColumnSummary`: A data model used to represent summaries of data columns, defined in `marimo._data.models`.
- `DependencyManager`: A utility for managing optional dependencies, defined in `marimo._dependencies.dependencies`.

## Symbols

### `TestDataFrameProtocolTableManager`
#### Description
This class is a test suite for the `DataFrameProtocolTableManager` class. It uses the `unittest` framework to define a series of tests that verify the behavior of the `DataFrameProtocolTableManager` methods.

#### Inputs
- None directly, but it uses a `pyarrow.Table` object as test data.

#### Outputs
- None directly, but it asserts expected outcomes for various methods of `DataFrameProtocolTableManager`.

#### Internal Logic
- **`setUp` Method**: Initializes a `pyarrow.Table` with sample data and creates an instance of `DataFrameProtocolTableManager` using this data.
- **`test_to_csv` Method**: Verifies that the `to_csv` method returns a `bytes` object.
- **`test_to_json` Method**: Verifies that the `to_json` method returns a `bytes` object.
- **`test_select_rows` Method**: Tests the `select_rows` method by selecting specific rows and comparing the result to expected data.
- **`test_select_rows_empty` Method**: Tests the `select_rows` method with an empty list of indices, expecting zero rows in the result.
- **`test_select_columns` Method**: Tests the `select_columns` method by selecting specific columns and comparing the result to expected data.
- **`test_get_row_headers` Method**: Verifies that the `get_row_headers` method returns an empty list.
- **`test_is_type` Method**: Tests the `is_type` method to ensure it correctly identifies DataFrame-like objects.
- **`test_get_field_types` Method**: Verifies that the `get_field_types` method returns the correct field types for the data.
- **`test_limit` Method**: Tests the `limit` method by limiting the data to a specified number of rows.
- **`test_summary_*` Methods**: These methods test the `get_summary` method for different data types (integer, string, number, boolean, date) to ensure it returns the correct summary statistics.
- **`test_apply_formatting` Methods**: These methods test the `apply_formatting` method with various format mappings to ensure data is formatted correctly.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `pytest` | Used for marking tests to be skipped if dependencies are not installed. |
| `unittest` | Provides the testing framework for the test suite. |
| `pyarrow` | Used for creating and manipulating table data in the tests. |

## Error Handling

The test suite uses assertions to verify expected outcomes. If an assertion fails, it indicates a discrepancy between the expected and actual behavior of the `DataFrameProtocolTableManager` methods.

## Logging

No explicit logging is implemented in this test suite. The `unittest` framework handles test results and outputs.

## TODOs

No TODOs or notes are present in the code.