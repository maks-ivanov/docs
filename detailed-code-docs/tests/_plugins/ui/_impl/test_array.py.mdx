---
title: "test_array.py"
---

## High-level description

The target file `test_array.py` contains unit tests for the `ui.array` component from the `marimo` library. These tests verify the behavior of the `ui.array` component when it is used to group other UI elements, ensuring that it correctly handles value updates, cloning of elements, and container-like operations. The tests also check the component's behavior in scenarios involving nested arrays and custom equality checks.

## Code Structure

The main symbols in the code are the test functions, each of which tests a specific aspect of the `ui.array` component. These functions use various UI elements like `ui.dropdown`, `ui.text`, `ui.slider`, and `ui.button` to create arrays and test their behavior. The tests ensure that the `ui.array` component correctly manages its elements and updates its values based on interactions.

## Symbols

### `test_array`
#### Description
Tests the basic functionality of the `ui.array` component, including default values, cloning of elements, and updating values.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- Initializes a `ui.array` with a dropdown, text, and slider.
- Asserts that the initial values are set correctly.
- Verifies that elements are cloned by checking their text and IDs.
- Updates the array's values and checks that the updates are reflected correctly.

### `test_nested_array`
#### Description
Tests the behavior of nested `ui.array` components, ensuring that updates to nested arrays do not affect the original arrays.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- Creates a nested array structure with sliders and text elements.
- Verifies that elements are cloned correctly.
- Updates the outer array and checks that the inner array remains unchanged.

### `test_update_on_frontend_value_change_only`
#### Description
Ensures that the `ui.array` component only registers updates when the frontend value changes.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- Initializes an array with a button element.
- Performs multiple updates with the same value and asserts that only one update is registered.

### `test_update_checks_against_frontend_value`
#### Description
Tests the `ui.array` component's behavior when handling elements with custom equality checks.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- Defines a class `NoEquality` with custom equality methods that raise exceptions.
- Creates an array with a dropdown containing an instance of `NoEquality`.
- Updates the array and verifies that the update does not raise an exception.

### `test_container_emulation`
#### Description
Tests the `ui.array` component's ability to emulate container-like behavior, such as length, iteration, and item access.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- Initializes an array with slider and text elements.
- Verifies container operations like `len`, `reversed`, `getitem`, `iter`, and `contains`.
- Asserts that item assignment raises a `TypeError`.

## References

- The `ui` module from `marimo._plugins` is referenced to create UI elements like `dropdown`, `text`, `slider`, and `button`.
- The `UIElement` class from `marimo._plugins.ui._core.ui_element` is likely the base class for these UI components, providing methods and properties used in the tests.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `pytest`   | Used for running the unit tests and handling assertions. |

## Error Handling

The tests include error handling for expected exceptions, such as verifying that item assignment raises a `TypeError`.

## Logging

No explicit logging mechanisms are implemented in the test code.

## TODOs

No TODOs or notes are present in the code.