---
title: "test_dataframe_utils.py"
---

## High-level description

The target file `test_dataframe_utils.py` is a test suite designed to validate the functionality of utility functions related to dataframes within the Marimo project. It primarily tests the retrieval of row headers from various types of data structures, including Pandas DataFrames, and ensures that the correct table manager is returned for different data types. The tests are conditionally executed based on the presence of optional dependencies like Pandas.

## Code Structure

The main symbols in the code are the test functions and the utility function `_get_row_headers`. The test functions use the `pytest` framework to validate the behavior of `_get_row_headers` and `get_table_manager` functions. The `DependencyManager` is used to check for the presence of optional dependencies, which influences whether certain tests are executed.

## References

- `DependencyManager`: Used to check if the Pandas library is installed.
- `get_table_manager`: A function from the `marimo._plugins.ui._impl.tables.utils` module, used to obtain a table manager for a given data structure.

## Symbols

### `_get_row_headers`
#### Description
This function retrieves the row headers from a given data structure by utilizing a table manager specific to the data type.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | Any | The data structure from which to retrieve row headers. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| row_headers | list[str] | A list of row header names. |

#### Internal Logic
1. The function calls `get_table_manager` to obtain a manager for the provided data.
2. It then uses the manager to retrieve and return the row headers.

### `test_get_row_headers_pandas`
#### Description
Tests the `_get_row_headers` function with various Pandas DataFrame configurations, including standard DataFrames, MultiIndex, RangeIndex, and CategoricalIndex.

#### Inputs
None directly, but it uses internally created Pandas DataFrames.

#### Outputs
None directly, but it asserts expected outcomes.

#### Internal Logic
- Creates different types of Pandas DataFrames.
- Asserts that `_get_row_headers` returns the expected row headers for each DataFrame type.

### `test_get_row_headers_list`
#### Description
Tests the `_get_row_headers` function with a non-DataFrame input, specifically a list.

#### Inputs
None directly, but it uses a list as input.

#### Outputs
None directly, but it asserts that the output is an empty list.

### `test_get_table_manager`
#### Description
Tests the `get_table_manager` function with various data structures, ensuring that a valid table manager is returned.

#### Inputs
None directly, but it uses various data structures like Pandas DataFrames, Polars DataFrames, and PyArrow tables.

#### Outputs
None directly, but it asserts that a non-None table manager is returned for each data structure.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `pytest` | Used for writing and executing test cases. |
| `pandas` | Used to create DataFrame objects for testing. |
| `polars` | Used to test compatibility with Polars DataFrames. |
| `pyarrow` | Used to test compatibility with PyArrow tables. |
| `narwhals` | Used to test compatibility with Narwhals DataFrames. |

## Error Handling

The test functions use `pytest.mark.skipif` to conditionally skip tests if certain dependencies are not installed, ensuring that the test suite can run even if optional dependencies are missing.

## Logging

No explicit logging is implemented in this test suite. The focus is on assertions to validate functionality.

## TODOs

No TODOs or notes are present in the code.