---
title: "test_nav_menu.py"
---

## High-level description

The target file `test_nav_menu.py` contains unit tests for the `_build_and_validate_menu` function from the `nav_menu` module. This function is responsible for constructing and validating a navigation menu structure from a given dictionary input. The tests ensure that the function correctly handles various input scenarios, including valid and invalid menu configurations.

## Code Structure

The main symbol in the target file is the `test_build_and_validate_menu` function, which contains multiple test cases. Each test case checks a different aspect of the `_build_and_validate_menu` function's behavior, such as handling simple menus, nested menus, and invalid inputs.

## References

- `_build_and_validate_menu`: This function is imported from the `marimo._plugins.stateless.nav_menu` module and is the primary focus of the tests in the target file.
- `NavMenu`, `NavMenuItemGroup`, `NavMenuItemLink`: These classes are used to represent the structure of the navigation menu and are part of the validation process.

## Symbols

### `test_build_and_validate_menu`
#### Description
This function is a collection of unit tests designed to verify the functionality of the `_build_and_validate_menu` function. It checks whether the function can correctly build and validate a navigation menu from various input dictionaries.

#### Inputs
The function does not take any inputs directly, as it is a test function. Instead, it defines several test cases with different menu configurations.

#### Outputs
The function does not return any outputs. It uses assertions to validate the behavior of `_build_and_validate_menu`.

#### Internal Logic
- **Simple Menu Test**: Verifies that a simple dictionary with string values is correctly converted into a `NavMenu` object with `NavMenuItemLink` items.
- **Absolute Href Test**: Checks that a menu with an absolute URL is correctly processed.
- **Nested Menu Test**: Ensures that a nested dictionary is converted into a `NavMenu` object with `NavMenuItemGroup` items.
- **Invalid Href Test**: Confirms that a `ValueError` is raised when a menu item has an invalid href.
- **Invalid Menu Item Test**: Checks that a `ValueError` is raised when a menu item has a non-string value.
- **Missing Label in Submenu Test**: Verifies that a `ValueError` is raised when a submenu item is missing a label.
- **Non-string Description in Submenu Test**: Ensures that a `ValueError` is raised when a submenu item has a non-string description.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `pytest` | Used for running the test cases and handling exceptions. |

## Error Handling

The test function uses `pytest.raises` to check that the `_build_and_validate_menu` function raises `ValueError` exceptions for invalid input scenarios. This ensures that the function correctly handles errors by raising appropriate exceptions.

## Logging

There is no explicit logging implemented in the test file. The focus is on using assertions and exception handling to verify the correctness of the `_build_and_validate_menu` function.