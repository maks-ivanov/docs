---
title: "test_utils.py"
---

## High-level description

The target file `tests/_server/test_utils.py` contains unit tests for two utility functions, `require_header` and `parse_title`, which are defined in the `marimo._server.api.utils` module. These tests verify the correct behavior of these functions by checking their outputs against expected results and ensuring they handle edge cases appropriately.

## Code Structure

The main symbols in the code are the test functions `test_require_header` and `test_parse_title`. These functions are designed to test the behavior of the `require_header` and `parse_title` functions, respectively, from the `marimo._server.api.utils` module. The tests use the `pytest` framework to assert expected outcomes and handle exceptions.

## References

- `require_header`: This function is imported from `marimo._server.api.utils` and is tested in `test_require_header`.
- `parse_title`: This function is imported from `marimo._server.api.utils` and is tested in `test_parse_title`.

## Symbols

### `test_require_header`
#### Description
This function tests the `require_header` function to ensure it behaves correctly when given valid and invalid inputs. It checks that the function returns the correct header value when a single header is provided and raises a `ValueError` when no headers or multiple headers are provided.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | N/A  | This function does not take any parameters. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | N/A  | This function does not return any value. |

#### Internal Logic
- The function first tests the "happy path" where a single header is provided, expecting the function to return that header.
- It then tests the case where `None` is passed as the header, expecting a `ValueError` to be raised.
- Finally, it tests the case where an empty list is passed as the header, again expecting a `ValueError`.

### `test_parse_title`
#### Description
This function tests the `parse_title` function to ensure it correctly parses filenames into a human-readable title format. It checks various cases, including filenames with extensions, paths, and special cases like `None` or empty strings.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | N/A  | This function does not take any parameters. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | N/A  | This function does not return any value. |

#### Internal Logic
- The function tests several scenarios:
  - When `None` is passed, it expects the default title "marimo".
  - It checks filenames with different extensions and underscores, expecting them to be converted to spaces and stripped of their extensions.
  - It tests paths to ensure only the filename is considered.
  - It handles edge cases like filenames without extensions and empty strings.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `pytest`   | Used for writing and executing the unit tests. |

## Error Handling

The tests in this file handle errors by using `pytest.raises` to assert that specific exceptions are raised when invalid inputs are provided to the functions being tested.

## Logging

There is no logging implemented in this test file.

## TODOs

There are no TODOs or notes left in the code.