---
title: "test_recents.py"
---

## High-level description

The target file `tests/_server/test_recents.py` contains unit tests for the `RecentFilesManager` class, which is part of the `marimo._server.recents` module. These tests verify the functionality of managing recent files, including adding new files, renaming existing files, and handling configurations related to recent files.

## Code Structure

The main symbol in the target file is the `TestRecentFilesManager` class, which is a subclass of `unittest.TestCase`. This class contains several test methods that validate the behavior of the `RecentFilesManager` class. The tests use the `unittest.mock` library to mock dependencies and isolate the functionality of the `RecentFilesManager`.

## References

- `RecentFilesManager`: The class being tested, which is responsible for managing recent files.
- `RecentFilesState`: A data class used to represent the state of recent files.
- `ConfigReader`: A utility class used to read and write configuration files, mocked in the tests.

## Symbols

### `TestRecentFilesManager`
#### Description
The `TestRecentFilesManager` class is a test suite for the `RecentFilesManager` class. It uses the `unittest` framework to define and run tests that ensure the correct behavior of recent file management operations.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mock_config_reader | Mock | A mock object for the `ConfigReader` class, used to simulate configuration file interactions. |

#### Outputs
The test methods do not return outputs but assert expected behaviors and interactions with the `ConfigReader`.

#### Internal Logic
- **setUp**: Initializes the test environment by creating a mock `ConfigReader` and an instance of `RecentFilesManager`. The mock is used to simulate configuration file operations.
- **test_touch_no_config**: Verifies that when a file is touched without an existing configuration, no read or write operations are performed on the configuration.
- **test_touch_with_config**: Checks that touching a file with an existing configuration reads the configuration correctly.
- **test_touch_with_config_existing_file**: Ensures that touching an already existing file updates its position in the recent files list and writes the updated configuration.
- **test_rename_no_config**: Tests renaming a file in the absence of a configuration, ensuring the configuration is read and updated correctly.
- **test_touch_with_config_max_files**: Validates that when the maximum number of recent files is reached, adding a new file removes the oldest file from the list.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `unittest` | Provides the framework for writing and running tests. |
| `unittest.mock` | Allows for mocking objects and functions to isolate the code under test. |

## Error Handling

The test cases do not explicitly handle errors but rely on assertions to ensure that the `RecentFilesManager` behaves as expected. If the behavior deviates from expectations, the tests will fail, indicating an issue.

## Logging

The test file does not implement any logging mechanisms. It relies on the `unittest` framework's output to report test results.

## TODOs

There are no TODOs or notes left in the code.