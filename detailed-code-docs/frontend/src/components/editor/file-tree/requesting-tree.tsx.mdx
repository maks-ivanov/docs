---
title: "requesting-tree.tsx"
---

## High-level description

The `RequestingTree` class in the `requesting-tree.tsx` file is designed to manage a file tree structure in a frontend application. It provides methods to initialize the tree, expand directories, rename, move, create, and delete files or folders, and refresh the tree's data. The class interacts with a backend service to perform these operations and updates the UI accordingly.

## Code Structure

The `RequestingTree` class is the main symbol in this file. It uses a `SimpleTree` from the `react-arborist` library to manage the file tree data. The class relies on callback functions for network requests to perform file operations, which are passed in during instantiation. It also uses utility functions for error handling and path manipulation.

## Symbols

### `RequestingTree`
#### Description
The `RequestingTree` class manages a file tree structure, providing methods to interact with files and folders, such as listing, creating, renaming, moving, and deleting them. It uses network requests to perform these operations and updates the UI through a callback function.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| callbacks | Object | An object containing callback functions for network requests related to file operations. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| N/A | N/A | The class does not return outputs directly but updates the UI through a callback function. |

#### Internal Logic
- **Initialization**: The `initialize` method sets up the file tree by fetching the root directory's files and setting the root path.
- **Expansion**: The `expand` method loads the children of a directory node if they are not already loaded.
- **Renaming**: The `rename` method changes the name and path of a file or folder and updates its children.
- **Moving**: The `move` method changes the parent of a file or folder and updates its path.
- **Creation**: The `createFile` and `createFolder` methods create new files or folders under a specified parent.
- **Deletion**: The `delete` method removes a file or folder from the tree.
- **Refreshing**: The `refreshAll` method refreshes the data for specified folders.
- **Error Handling**: The `handleResponse` method handles responses from network requests, displaying errors using a toast notification if necessary.

## Side Effects
- The class updates the UI by calling the `onChange` callback with the current state of the file tree.
- It displays toast notifications for errors encountered during network requests.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `react-arborist` | Used for managing the file tree structure. |
| `@/components/ui/use-toast` | Used for displaying toast notifications. |
| `@/core/network/requests` | Provides the network request functions for file operations. |
| `@/utils/errors` | Provides utility functions for error handling. |
| `@/utils/functions` | Provides utility functions, including a no-operation function. |
| `@/utils/paths` | Provides utility functions for path manipulation. |

## Error Handling
The `RequestingTree` class uses the `prettyError` function to format error messages and displays them using toast notifications. The `handleResponse` method checks the success of network responses and handles errors by showing a toast with the error message.

## Logging
The class uses toast notifications to log errors encountered during network requests, providing feedback to the user.

## References
- The `RequestingTree` class is referenced in the `file-explorer.tsx` file, where it is used to manage the file tree in the `FileExplorer` component.
- The `treeAtom` in `state.tsx` initializes a `RequestingTree` instance for state management.

## TODOs
There are no TODOs or notes left in the code.