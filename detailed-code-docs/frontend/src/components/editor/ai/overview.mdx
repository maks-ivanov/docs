---
title: "Overview"
---

## High-level description

The `add-cell-with-ai.tsx` file defines a React component named `AddCellWithAI`. This component provides a user interface for generating code using AI and adding it as a new cell in a notebook-like environment. It integrates with an AI completion API to generate code suggestions based on user input and existing code context, and allows users to accept or reject these suggestions.

## Code Structure

The main symbols in the code are interconnected as follows:
- `AddCellWithAI` is the primary React component that manages the UI and logic for AI-based code generation.
- It uses hooks like `useCellActions` to interact with the notebook's cell management system.
- The component leverages the `useCompletion` hook to handle AI completion logic, including API interaction and state management.
- UI elements such as `Button` and icons (`Loader2Icon`, `SparklesIcon`, `XIcon`) are used to create the interactive interface.
- Utility functions like `cn` for class name management and `toast` for error notifications are also utilized.

## References

- `useCellActions` from `../../../core/cells/cells` is used to create new cells in the notebook.
- `getCodes` from `@/core/codemirror/copilot/getCodes` is used to gather existing code context for AI suggestions.
- `API` from `@/core/network/api` is used to configure headers for API requests.
- `prettyError` from `@/utils/errors` is used to format error messages.
- `asURL` from `@/utils/url` is used to construct the API endpoint URL.

## Symbols

### `AddCellWithAI`
#### Description
The `AddCellWithAI` component provides a user interface for generating code using AI and adding it as a new cell in a notebook. It manages user input, interacts with an AI completion API, and handles the acceptance or rejection of AI-generated code.

#### Inputs
| Name   | Type     | Description                  |
|:-------|:---------|:-----------------------------|
| onClose | `() =&gt; void` | Callback function to close the component |

#### Outputs
The component does not have direct outputs but interacts with the notebook state to add new cells.

#### Internal Logic
- Initializes the `useCompletion` hook with API configuration and error handling.
- Renders an input field for user interaction, with event handlers for submitting input or closing the component.
- Displays a loading indicator and buttons for stopping the AI generation or accepting the generated code.
- On acceptance, it creates a new cell with the generated code and resets the completion state.

## Side Effects
- Modifies the notebook state by adding new cells through `createNewCell`.
- Displays toast notifications for errors using the `toast` function.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `react` | Provides the base for creating React components. |
| `@uiw/react-codemirror` | Used for rendering the code editor with CodeMirror. |
| `lucide-react` | Provides icons for the UI. |
| `@/utils/cn` | Utility for managing class names. |
| `@/components/ui/button` | UI component for rendering buttons. |
| `@/components/ui/use-toast` | Utility for displaying toast notifications. |
| `@/core/codemirror/language/python` | Provides Python language support for CodeMirror. |
| `@/core/network/api` | Handles API requests and configurations. |
| `@/utils/errors` | Utility for formatting error messages. |
| `@/utils/url` | Utility for constructing URLs. |

## Error Handling
- Errors during AI completion are caught and displayed using toast notifications with a formatted error message.

## Logging
No explicit logging is implemented in this component.

## TODOs
There are no TODOs or notes left in the code.