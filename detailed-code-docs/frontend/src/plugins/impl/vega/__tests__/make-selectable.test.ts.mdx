---
title: "make-selectable.test.ts"
---

## High-level description

The target file contains a suite of unit tests for the `makeSelectable` function, which is part of a Vega-Lite visualization plugin. The tests verify that the function correctly modifies Vega-Lite specifications to make chart elements selectable, based on various configurations and conditions. The tests cover different scenarios, including different mark types, selection configurations, and multi-layered charts.

## Code Structure

The main symbol in the code is the `makeSelectable` function, which is tested extensively in this file. The tests are organized using the `describe` and `it` blocks from the `vitest` testing framework. Each test case provides a specific Vega-Lite specification and checks the output of `makeSelectable` against expected results using snapshot testing and direct comparisons.

## References

- `makeSelectable`: The function being tested, which is imported from `../make-selectable`.
- `VegaLiteSpec`: A type imported from `../types` that represents the structure of a Vega-Lite specification.
- `getSelectionParamNames`: A utility function imported from `../params` that retrieves the names of selection parameters from a Vega-Lite specification.

## Symbols

### `describe`
#### Description
The `describe` function is used to group related test cases for the `makeSelectable` function. It provides a context for the tests and is part of the `vitest` testing framework.

### `it`
#### Description
The `it` function defines individual test cases within the `describe` block. Each test case checks a specific aspect of the `makeSelectable` function's behavior.

### `makeSelectable`
#### Description
The `makeSelectable` function modifies a Vega-Lite specification to add interactivity features, such as selection and pan/zoom capabilities, based on the provided options.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| spec | `VegaLiteSpec` | The Vega-Lite specification to be modified. |
| opts | `object` | Options to configure the selection behavior, including `chartSelection` and `fieldSelection`. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| output | `VegaLiteSpec` | The modified Vega-Lite specification with added interactivity features. |

### `getSelectionParamNames`
#### Description
This function extracts the names of selection parameters from a given Vega-Lite specification. It is used in the tests to verify that the correct selection parameters are added by `makeSelectable`.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| spec | `TopLevelSpec` or `LayerSpec&lt;Field&gt;` or `UnitSpec&lt;Field&gt;` | The Vega-Lite specification from which to extract selection parameter names. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| output | `string[]` | A list of selection parameter names present in the specification. |

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `vitest` | Provides the testing framework used to define and run the test cases. |

## Error Handling

The test cases do not explicitly handle errors, as they rely on the `vitest` framework to catch and report any exceptions or assertion failures that occur during the tests.

## Logging

There is no explicit logging in the test cases. The `vitest` framework handles output and reporting of test results.

## API/Interface Reference

The `makeSelectable` function is the primary interface being tested. It takes a Vega-Lite specification and options as input and returns a modified specification. The tests verify its behavior under various conditions, ensuring it correctly adds selection and interactivity features to the specification.