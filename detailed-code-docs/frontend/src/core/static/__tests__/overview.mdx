---
title: "Overview"
---

## High-level description

The `__tests__` directory within the `frontend/src/core/static` path contains unit tests for various components related to handling virtual files and asset URLs in a web application. The tests are designed to ensure the correct functionality of functions and classes that manage asset URLs, virtual file requests, and virtual file tracking. The main components tested include the `updateAssetUrl` function, `patchFetch` and `patchVegaLoader` functions, and the `VirtualFileTracker` class along with the `findVirtualFiles` function.

## What does it do?

The tests in this directory verify the behavior of several key functionalities:

1. **Asset URL Handling**: The `updateAssetUrl` function is tested to ensure it correctly converts relative and absolute URLs to a standardized format using a specified base URL. It also checks that URLs from the same origin remain unchanged.

2. **Virtual File Handling**: The `patchFetch` and `patchVegaLoader` functions are tested to ensure they correctly intercept and handle requests for virtual files. These functions return appropriate content for virtual files and fall back to original methods for non-virtual files.

3. **Virtual File Tracking**: The `VirtualFileTracker` class and `findVirtualFiles` function are tested to verify their ability to track and identify virtual file paths. The `VirtualFileTracker` manages virtual files associated with specific cell IDs, while `findVirtualFiles` extracts virtual file paths from strings or objects.

## Entry points

The directory contains multiple test files, each focusing on different functionalities:

- **`download-html.test.ts`**: Tests the `updateAssetUrl` function for handling asset URLs.
- **`files.test.ts`**: Tests the `patchFetch` and `patchVegaLoader` functions for handling virtual file requests.
- **`virtual-file-tracker.test.ts`**: Tests the `VirtualFileTracker` class and `findVirtualFiles` function for tracking and identifying virtual files.

## Dependencies

The tests in this directory rely on the `vitest` testing framework, which provides the necessary tools for writing and executing unit tests. Additionally, the `node:http` module is used to create a mock HTTP server for testing purposes in the `files.test.ts` file. These dependencies are chosen to facilitate the testing of asynchronous operations and HTTP requests in a controlled environment.