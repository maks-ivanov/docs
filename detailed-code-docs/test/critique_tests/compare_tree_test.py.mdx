---
title: "compare_tree_test.py"
---

## High-level description

The `compare_tree_test.py` file contains unit tests for the `cassiopeia.critique.compare` module, specifically focusing on tree comparison functionalities. It uses the `unittest` framework to validate the correctness of various tree comparison methods, such as triplet correctness and Robinson-Foulds distance, by comparing different tree structures.

## Code Structure

The main class in this file is `TestTreeComparisons`, which inherits from `unittest.TestCase`. This class contains several test methods that validate the behavior of tree comparison functions from the `cassiopeia.critique` module. The tests are organized to check different scenarios, such as comparing identical trees, different trees, multifurcating trees, and rake trees.

## Symbols

### `TestTreeComparisons`
#### Description
This class is a test suite for validating tree comparison functions in the `cassiopeia.critique` module. It sets up various tree structures and tests the correctness of tree comparison metrics.

#### Inputs
- None directly, but it uses predefined tree structures within its methods.

#### Outputs
- None directly, but it asserts expected outcomes for various tree comparison functions.

#### Internal Logic
- **`setUp` Method**: Initializes several tree structures using `networkx` and wraps them in `CassiopeiaTree` objects. These trees are used in the test methods to validate tree comparison functions.
- **`test_out_group` Method**: Tests the `get_outgroup` function to ensure it correctly identifies the outgroup in a given set of nodes.
- **`test_same_tree_gives_perfect_triplets_correct` Method**: Validates that comparing a tree with itself results in perfect triplet correctness.
- **`test_triplets_correct_different_trees` Method**: Checks the triplet correctness when comparing different trees.
- **`test_triplets_correct_multifurcating_same_tree` Method**: Tests triplet correctness for a multifurcating tree compared with itself, including the proportion of unresolvable triplets.
- **`test_triplets_correct_multifurcating_different_trees` Method**: Validates triplet correctness for multifurcating trees that are different.
- **`test_rake_tree` Method**: Ensures that a rake tree compared with itself has the expected triplet correctness and unresolvable proportions.
- **`test_robinson_foulds_same_tree_bifurcating` Method**: Tests the Robinson-Foulds distance for a bifurcating tree compared with itself, expecting a distance of zero.

## References

- `cas.data.CassiopeiaTree`: Used to wrap `networkx` tree structures for testing.
- `cas.critique.critique_utilities.get_outgroup`: Function tested for outgroup determination.
- `cas.critique.triplets_correct`: Function tested for triplet correctness.
- `cas.critique.robinson_foulds`: Function tested for Robinson-Foulds distance.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `unittest` | Provides the testing framework. |
| `networkx` | Used to create and manipulate graph structures representing trees. |
| `numpy` | Imported but not directly used in the provided code. |
| `pandas` | Imported but not directly used in the provided code. |
| `cassiopeia` | Provides the `CassiopeiaTree` class and critique functions for tree comparison. |

## Error Handling

The test methods use assertions to validate expected outcomes. If an assertion fails, it indicates a discrepancy between the expected and actual behavior of the tree comparison functions.

## Logging

No explicit logging is implemented in this test file. The `unittest` framework handles test results and outputs.

## TODOs

No TODOs or notes are present in the code.