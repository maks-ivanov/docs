---
title: "clonal_spatial_simulator_test.py"
---

## High-level description

The `clonal_spatial_simulator_test.py` file contains unit tests for the `ClonalSpatialDataSimulator` class, which is part of the Cassiopeia library. This simulator is designed to generate spatial data for a given tree structure, ensuring that clonal populations are spatially localized. The tests verify the initialization, data overlay functionality, and integration with existing cell metadata.

## Code Structure

The main class in this file is `TestClonalSpatialDataSimulator`, which is a subclass of `unittest.TestCase`. It contains several test methods that validate different aspects of the `ClonalSpatialDataSimulator` class. The tests are organized as follows:

- `setUp`: Initializes common test data, including a tree structure and cell metadata.
- `test_init`: Tests the initialization of the simulator, including error handling and space setup.
- `test_overlay_data`: Verifies that spatial data is correctly overlaid onto a tree without pre-existing cell metadata.
- `test_overlay_data_with_space`: Similar to `test_overlay_data`, but with a predefined space.
- `test_overlay_data_with_existing_cell_meta`: Ensures that spatial data is correctly integrated with existing cell metadata.

## References

- `ClonalSpatialDataSimulator`: The class being tested, which is responsible for simulating spatial data.
- `DataSimulatorError`: An exception class used to handle errors specific to data simulation.

## Symbols

### `TestClonalSpatialDataSimulator`
#### Description
A test suite for the `ClonalSpatialDataSimulator` class, ensuring its methods function as expected.

#### Methods

- **`setUp`**: Prepares the test environment by setting up a tree structure and cell metadata.
- **`test_init`**: Tests the initialization of the simulator, checking for correct dimension setup and error handling.
- **`test_overlay_data`**: Validates the overlay of spatial data onto a tree without existing metadata.
- **`test_overlay_data_with_space`**: Similar to `test_overlay_data`, but tests with a predefined space.
- **`test_overlay_data_with_existing_cell_meta`**: Ensures spatial data is correctly integrated with existing cell metadata.

#### Inputs
- **`setUp`**: No direct inputs; initializes test data.
- **`test_init`**: No direct inputs; uses initialized data.
- **`test_overlay_data`**: No direct inputs; uses initialized data.
- **`test_overlay_data_with_space`**: No direct inputs; uses initialized data.
- **`test_overlay_data_with_existing_cell_meta`**: No direct inputs; uses initialized data.

#### Outputs
- **`setUp`**: No direct outputs; prepares test data.
- **`test_init`**: Asserts correct initialization and error handling.
- **`test_overlay_data`**: Asserts correct spatial data overlay.
- **`test_overlay_data_with_space`**: Asserts correct spatial data overlay with predefined space.
- **`test_overlay_data_with_existing_cell_meta`**: Asserts correct integration with existing metadata.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `unittest` | Provides the testing framework. |
| `networkx` | Used for creating and manipulating the tree structure. |
| `numpy` | Utilized for numerical operations and assertions. |
| `pandas` | Used for handling cell metadata. |
| `cassiopeia` | The main library being tested, specifically the `ClonalSpatialDataSimulator` class. |

## Error Handling

The test suite checks for `DataSimulatorError` during the initialization of the `ClonalSpatialDataSimulator` to ensure proper error handling when required parameters are missing.

## Logging

No explicit logging is implemented in the test suite. The `unittest` framework handles test results and outputs.

## TODOs

No TODOs or notes are present in the code.