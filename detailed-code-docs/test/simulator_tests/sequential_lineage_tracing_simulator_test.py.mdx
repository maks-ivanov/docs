---
title: "sequential_lineage_tracing_simulator_test.py"
---

## High-level description

The target file `sequential_lineage_tracing_simulator_test.py` is a unit test suite designed to test the functionality of the `SequentialLineageTracingDataSimulator` class from the `cassiopeia.simulator` module. This test suite uses the `unittest` framework to verify that the simulator correctly initializes, handles errors, and overlays lineage tracing data onto a tree structure. It also checks the simulator's behavior with different configurations, including scenarios with missing data.

## Code Structure

The main class in this file is `TestSequentialLineageTracingDataSimulator`, which inherits from `unittest.TestCase`. This class contains several test methods that validate different aspects of the `SequentialLineageTracingDataSimulator`. The tests are organized into setup, basic functionality, error handling, and specific simulation scenarios.

## Symbols

### `TestSequentialLineageTracingDataSimulator`
#### Description
This class is a test suite for the `SequentialLineageTracingDataSimulator`. It contains methods to set up test data, verify the simulator's basic setup, handle setup errors, and test the simulator's data overlay functionality.

#### Methods

- **`setUp`**
  - **Description**: Initializes the test environment by creating a tree topology and two instances of `SequentialLineageTracingDataSimulator` with different configurations.
  - **Inputs**: None
  - **Outputs**: None
  - **Internal Logic**: Constructs a directed graph representing a tree, sets node times, and initializes simulator instances with specific parameters.

- **`test_basic_setup`**
  - **Description**: Tests the basic setup of the `SequentialLineageTracingDataSimulator` to ensure it initializes with the correct parameters.
  - **Inputs**: None
  - **Outputs**: None
  - **Internal Logic**: Asserts that the simulator's parameters match expected values.

- **`test_setup_errors`**
  - **Description**: Tests the simulator's error handling by providing invalid parameters and ensuring that `DataSimulatorError` is raised.
  - **Inputs**: None
  - **Outputs**: None
  - **Internal Logic**: Uses `assertRaises` to check for errors when invalid parameters are passed to the simulator.

- **`test_simulator_basic`**
  - **Description**: Tests the simulator's ability to overlay data onto a tree and verifies the resulting character matrix.
  - **Inputs**: None
  - **Outputs**: None
  - **Internal Logic**: Overlays data on a tree, checks the shape of the character matrix, and compares it to an expected matrix.

- **`test_simulator_with_missing`**
  - **Description**: Tests the simulator's behavior when there is missing data, ensuring the character matrix reflects this correctly.
  - **Inputs**: None
  - **Outputs**: None
  - **Internal Logic**: Similar to `test_simulator_basic`, but with a simulator configured to introduce missing data.

- **`test_branch_multiple_edits`**
  - **Description**: Tests the simulator's handling of multiple edits on a branch, ensuring the character matrix is as expected.
  - **Inputs**: None
  - **Outputs**: None
  - **Internal Logic**: Sets up a simple tree, overlays data, and checks the resulting character matrix against an expected matrix.

## References

- **`SequentialLineageTracingDataSimulator`**: The class being tested, which is part of the `cassiopeia.simulator` module.
- **`DataSimulatorError`**: An error class used to handle invalid configurations in the simulator.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `unittest` | Provides the testing framework. |
| `networkx` | Used to create and manipulate the tree topology as a directed graph. |
| `numpy` | Utilized for numerical operations. |
| `pandas` | Used for handling data in DataFrame format, particularly for character matrices. |
| `cassiopeia` | The main library being tested, specifically its simulator module. |

## Error Handling

The test suite uses `unittest`'s `assertRaises` method to verify that the `SequentialLineageTracingDataSimulator` raises `DataSimulatorError` when initialized with invalid parameters. This ensures that the simulator's error handling is robust and correctly implemented.

## Logging

There is no explicit logging implemented in this test suite. The focus is on using assertions to validate expected outcomes.

## TODOs

There are no TODOs or notes left in the code.