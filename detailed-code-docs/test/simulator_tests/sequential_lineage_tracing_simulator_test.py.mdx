---
title: "sequential_lineage_tracing_simulator_test.py"
---

Here's a comprehensive documentation for the target file `test/simulator_tests/sequential_lineage_tracing_simulator_test.py`:

## High-level description
This file contains unit tests for the Sequential-based lineage tracing data simulator in the Cassiopeia package. It tests the functionality of the `SequentialLineageTracingDataSimulator` class, including its initialization, error handling, and data overlay capabilities.

## Code Structure
The main class `TestSequentialLineageTracingDataSimulator` inherits from `unittest.TestCase` and contains several test methods. It sets up a basic tree structure and simulator instances in the `setUp` method, which are then used across different test cases.

## Symbols

### TestSequentialLineageTracingDataSimulator
#### Description
A test class that contains unit tests for the `SequentialLineageTracingDataSimulator` class.

#### Internal Logic
1. Sets up a basic tree structure and simulator instances in `setUp`.
2. Tests basic setup, error handling, and data overlay functionality of the simulator.

### setUp
#### Description
Initializes the test environment by creating a basic tree structure and two simulator instances.

#### Internal Logic
1. Creates a directed graph representing a tree topology.
2. Converts the graph to a `CassiopeiaTree` and sets node times.
3. Initializes two `SequentialLineageTracingDataSimulator` instances with different parameters.

### test_basic_setup
#### Description
Tests the basic setup of the simulator, including the number of characters, silencing rates, and other parameters.

### test_setup_errors
#### Description
Tests various error conditions during simulator initialization, such as invalid input parameters.

### test_simulator_basic
#### Description
Tests the basic functionality of the simulator by overlaying data on the tree and checking the resulting character matrix.

### test_simulator_with_missing
#### Description
Tests the simulator's behavior when dealing with missing data (heritable and stochastic silencing).

### test_branch_multiple_edits
#### Description
Tests the simulator's ability to handle multiple edits along a branch.

## Dependencies
- unittest
- networkx
- numpy
- pandas
- cassiopeia

## Error Handling
The test cases check for various error conditions by using `self.assertRaises` to ensure that the simulator raises appropriate exceptions for invalid inputs.

## Performance Considerations
The tests don't explicitly address performance, but they do check the correctness of the simulator's output for different scenarios, which indirectly ensures efficient operation.

This documentation provides a comprehensive overview of the test file, its structure, and the various test cases it contains for the `SequentialLineageTracingDataSimulator` class in the Cassiopeia package.