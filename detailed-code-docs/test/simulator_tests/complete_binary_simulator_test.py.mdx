---
title: "complete_binary_simulator_test.py"
---

## High-level description
This file contains unit tests for the `CompleteBinarySimulator` class, which is responsible for simulating complete binary trees. The tests verify the initialization of the simulator and the structure of the simulated tree, including its nodes, edges, and branch lengths.

## Symbols

### TestCompleteBinarySimulator
#### Description
This is a test class that inherits from `unittest.TestCase`. It contains two test methods to verify the functionality of the `CompleteBinarySimulator` class.

### test_init
#### Description
This method tests the initialization of the `CompleteBinarySimulator` class.

#### Internal Logic
1. It checks that the simulator raises a `TreeSimulatorError` when initialized without arguments.
2. It verifies that the simulator raises an error when initialized with an invalid number of cells (not a power of 2).
3. It ensures that the simulator raises an error when initialized with an invalid depth (0).
4. It checks that the simulator correctly calculates the depth when initialized with a valid number of cells.

### test_simulate_tree
#### Description
This method tests the `simulate_tree()` function of the `CompleteBinarySimulator` class.

#### Internal Logic
1. It creates a simulator with a depth of 2 and simulates a tree.
2. It verifies the correct structure of the simulated tree by checking:
   - The set of all nodes
   - The set of leaf nodes
   - The set of edges
3. It checks the branch lengths (times) for each node in the tree.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| numpy | Used for numerical operations (not explicitly used in this test file) |
| unittest | Provides the testing framework |
| cassiopeia.mixins | Imports the `TreeSimulatorError` exception |
| cassiopeia.simulator | Imports the `CompleteBinarySimulator` class |

## Error Handling
The test cases explicitly check for `TreeSimulatorError` exceptions in the `test_init` method using `self.assertRaises()`. This ensures that the `CompleteBinarySimulator` class correctly raises exceptions for invalid inputs.

## References
The test file references the following external components:
- `CompleteBinarySimulator` class from `cassiopeia.simulator`
- `TreeSimulatorError` exception from `cassiopeia.mixins`

These components are defined in the related code snippets provided, specifically in the `cassiopeia/simulator/CompleteBinarySimulator.py` file.