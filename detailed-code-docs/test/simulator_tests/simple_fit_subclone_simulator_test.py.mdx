---
title: "simple_fit_subclone_simulator_test.py"
---

## High-level description

The target file `simple_fit_subclone_simulator_test.py` contains unit tests for the `SimpleFitSubcloneSimulator` class, which is part of the Cassiopeia library. This simulator is designed to model the evolution of a clonal population that develops a fit subclone over time. The tests verify both deterministic and stochastic behaviors of the simulator, ensuring that the generated phylogenetic trees meet expected structural and temporal properties.

## Code Structure

The main class in the target file is `TestSimpleFitSubcloneSimulator`, which is a subclass of `unittest.TestCase`. This class contains two test methods: `test_deterministic` and `test_stochastic`. These methods test different aspects of the `SimpleFitSubcloneSimulator` by simulating phylogenetic trees and checking their properties.

## References

- `SimpleFitSubcloneSimulator`: This is the class being tested, imported from `cassiopeia.simulator`. It is responsible for simulating the phylogenetic trees.

## Symbols

### `TestSimpleFitSubcloneSimulator`
#### Description
This class contains unit tests for the `SimpleFitSubcloneSimulator`. It uses the `unittest` framework to define and run tests that verify the simulator's functionality.

#### Methods

### `test_deterministic`
#### Description
This test method verifies the deterministic behavior of the `SimpleFitSubcloneSimulator`. It checks that the generated phylogenetic tree matches a predefined structure and timing when using constant branch lengths.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | N/A  | This method does not take any inputs directly. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | N/A  | The method asserts conditions and raises exceptions if they fail. |

#### Internal Logic
- Initializes a `SimpleFitSubcloneSimulator` with specific parameters for branch lengths and experiment duration.
- Calls `simulate_tree()` to generate a phylogenetic tree.
- Asserts that the nodes, edges, and times of the tree match expected values.

### `test_stochastic`
#### Description
This test method evaluates the stochastic behavior of the `SimpleFitSubcloneSimulator`. It ensures that the simulator can handle callable functions for branch lengths, resulting in non-deterministic tree structures.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | N/A  | This method does not take any inputs directly. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | N/A  | The method asserts conditions and raises exceptions if they fail. |

#### Internal Logic
- Sets a random seed for reproducibility.
- Defines two functions, `branch_length_neutral` and `branch_length_fit`, which return random exponential values.
- Initializes a `SimpleFitSubcloneSimulator` with these functions as branch lengths.
- Calls `simulate_tree()` to generate a phylogenetic tree.
- Asserts that all non-leaf branch lengths are distinct, confirming non-determinism.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `numpy` | Used for generating random numbers in the stochastic test. |
| `unittest` | Provides the testing framework for defining and running tests. |
| `cassiopeia.simulator.SimpleFitSubcloneSimulator` | The class being tested, responsible for simulating phylogenetic trees. |

## Error Handling

The test methods use assertions to verify expected outcomes. If an assertion fails, an exception is raised, indicating that the test did not pass.

## Logging

No explicit logging is implemented in the test file. The `unittest` framework handles test results and outputs.

## TODOs

There are no TODOs or notes left in the code.