---
title: "simple_fit_subclone_simulator_test.py"
---

## High-level description
The `TestSimpleFitSubcloneSimulator` class tests the `SimpleFitSubcloneSimulator` class, which simulates the growth of a cell population with a single subclone that emerges with a different fitness at a specific generation. The tests cover both deterministic and stochastic branch length generation.

## Code Structure
The `TestSimpleFitSubcloneSimulator` class contains two test methods that utilize the `SimpleFitSubcloneSimulator` to generate and validate simulated trees.

## Symbols
### `TestSimpleFitSubcloneSimulator`
#### Description
This class contains unit tests for the `SimpleFitSubcloneSimulator` class. It ensures the simulator generates the expected tree structure and branch lengths under different scenarios.

#### Inputs
- None

#### Outputs
- None (It runs assertions within the test methods)

#### Internal Logic
The class includes two test methods:
    - `test_deterministic`: This method tests the simulator with fixed branch lengths, verifying the resulting tree structure and node times.
    - `test_stochastic`: This method tests the simulator with branch lengths generated by provided callables, ensuring the stochasticity of the generated tree.

### `test_deterministic`
#### Description
This method tests the deterministic tree generation of the `SimpleFitSubcloneSimulator`. It sets up a simulator with specific parameters, simulates a tree, and asserts that the generated tree structure and node times match the expected values.

#### Inputs
- None

#### Outputs
- None (It runs assertions within the method)

#### Internal Logic
1. It initializes a `SimpleFitSubcloneSimulator` with fixed branch lengths (`branch_length_neutral` and `branch_length_fit`), experiment duration, and the generation at which the fit subclone appears.
2. It simulates a tree using the `simulate_tree` method of the simulator.
3. It asserts that the nodes, edges, and times of the generated tree match the expected values for the deterministic scenario.

### `test_stochastic`
#### Description
This method tests the stochastic tree generation of the `SimpleFitSubcloneSimulator`. It uses callable functions to generate branch lengths randomly, simulates a tree, and verifies that the branch lengths in the generated tree are all different, indicating stochasticity.

#### Inputs
- None

#### Outputs
- None (It runs assertions within the method)

#### Internal Logic
1. It defines two callable functions, `branch_length_neutral` and `branch_length_fit`, which return random branch lengths drawn from an exponential distribution.
2. It initializes a `SimpleFitSubcloneSimulator` with the callable branch length functions, experiment duration, and the generation at which the fit subclone appears.
3. It simulates a tree using the `simulate_tree` method of the simulator.
4. It extracts the branch lengths of all non-leaf nodes in the generated tree.
5. It asserts that the number of unique branch lengths is equal to the total number of extracted branch lengths, indicating that all branch lengths are different and generated stochastically.
