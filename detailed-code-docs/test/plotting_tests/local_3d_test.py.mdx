---
title: "local_3d_test.py"
---

## High-level description

The target file `local_3d_test.py` is a unit test suite for testing the functionality of the `local_3d` module within the `cassiopeia.plotting` package. This test suite uses the `unittest` framework to verify the correctness of various 3D plotting utilities, such as interpolating branches, creating polylines, mixing colors, and generating labels from spatial coordinates. It also tests the initialization and plotting capabilities of the `Tree3D` class.

## Code Structure

The test suite is structured as a class `TestLocal3DPlotting` that inherits from `unittest.TestCase`. This class contains several test methods, each designed to test a specific function or feature of the `local_3d` module. The `setUp` method is used to initialize common test data, such as a simulated tree and spatial data, which are used across multiple test cases.

## References

The test suite references the `local_3d` module from the `cassiopeia.plotting` package. It specifically tests functions and classes such as `interpolate_branch`, `polyline_from_points`, `average_mixing`, `highlight`, `lowlight`, `labels_from_coordinates`, and `Tree3D`.

## Symbols

### `TestLocal3DPlotting`
#### Description
This class is a test suite for the `local_3d` module, containing various test cases to ensure the correctness of 3D plotting functionalities.

#### Inputs
- None directly, but uses a simulated tree and spatial data initialized in the `setUp` method.

#### Outputs
- None directly, but asserts the correctness of various functionalities.

#### Internal Logic
- The `setUp` method initializes a simulated tree and overlays spatial data.
- Each test method verifies a specific function or feature of the `local_3d` module using assertions.

### `setUp`
#### Description
Initializes the test environment by setting up a simulated tree and spatial data.

#### Inputs
- None

#### Outputs
- None

#### Internal Logic
- Seeds the random number generator for reproducibility.
- Simulates a complete binary tree with 8 cells.
- Overlays spatial data onto the tree.
- Generates labels from the tree's spatial coordinates.

### `test_interpolate_branch`
#### Description
Tests the `interpolate_branch` function to ensure it correctly interpolates a branch between two points.

#### Inputs
| Name   | Type | Description                  |
|--------|------|------------------------------|
| parent | tuple | Parent coordinates as a triplet |
| child  | tuple | Child coordinates as a triplet  |

#### Outputs
- Asserts that the interpolated branch matches the expected coordinates.

### `test_polyline_from_points`
#### Description
Tests the `polyline_from_points` function to ensure it creates a correct Pyvista polyline from a set of points.

#### Inputs
| Name  | Type       | Description                |
|-------|------------|----------------------------|
| points | np.ndarray | Array of points to form a polyline |

#### Outputs
- Asserts that the polyline's points match the input points.

### `test_average_mixing`
#### Description
Tests the `average_mixing` function to ensure it correctly averages a set of colors.

#### Inputs
| Name | Type | Description |
|------|------|-------------|
| c1   | tuple | First color |
| c2   | tuple | Second color |
| c3   | tuple | Third color |

#### Outputs
- Asserts that the averaged color matches the expected result.

### `test_highlight`
#### Description
Tests the `highlight` function to ensure it correctly highlights a color.

#### Inputs
| Name | Type | Description |
|------|------|-------------|
| c    | tuple | Color to highlight |

#### Outputs
- Asserts that the highlighted color matches the expected result.

### `test_lowlight`
#### Description
Tests the `lowlight` function to ensure it correctly dims a color.

#### Inputs
| Name | Type | Description |
|------|------|-------------|
| c    | tuple | Color to dim |

#### Outputs
- Asserts that the dimmed color matches the expected result.

### `test_labels_from_coordinates`
#### Description
Tests the `labels_from_coordinates` function to ensure it generates correct labels from spatial coordinates.

#### Inputs
- Uses the tree initialized in `setUp`.

#### Outputs
- Asserts that the generated labels match expected conditions and handle errors correctly.

### `test_Tree3D`
#### Description
Tests the `Tree3D` class to ensure it initializes and plots without errors.

#### Inputs
- Uses the tree and labels initialized in `setUp`.

#### Outputs
- Asserts that no errors occur during initialization and plotting.

## Dependencies

| Dependency | Purpose |
|------------|---------|
| `unittest` | Provides the framework for writing and running tests. |
| `mock`     | Used for mocking objects in tests. |
| `networkx` | Used for creating and manipulating complex networks/graphs. |
| `numpy`    | Provides support for large, multi-dimensional arrays and matrices. |
| `pandas`   | Used for data manipulation and analysis. |
| `cassiopeia` | The main library being tested, specifically its `plotting` module. |

## Error Handling

The test suite uses assertions to handle errors. It checks for expected outcomes and raises errors if the actual results do not match the expected ones. Additionally, it tests for specific error conditions, such as invalid input shapes or attributes, to ensure the code handles these gracefully.

## Logging

No explicit logging is implemented in the test suite. The `unittest` framework provides output regarding test results, including any failures or errors encountered during execution.