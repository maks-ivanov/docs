---
title: "Overview"
---

## High-level description

The `test/preprocess_tests` directory contains a suite of unit tests designed to validate various preprocessing functionalities within the Cassiopeia pipeline. These tests ensure the correctness and robustness of different preprocessing steps, such as sequence alignment, allele calling, lineage grouping, character matrix formation, UMI collapsing, configuration parsing, and more. Each test file targets a specific function or module within the preprocessing pipeline, using the `unittest` framework to define and execute test cases.

## What does it do?

The tests in this directory are designed to simulate different scenarios and validate the expected behavior of the preprocessing functions. They cover a wide range of functionalities, including:

- **Sequence Alignment**: Tests ensure that sequences are aligned correctly, handling different penalties and alignment methods.
- **Allele Calling**: Tests verify the parsing of CIGAR strings and the correct identification of integration barcodes and indels.
- **Lineage Grouping**: Tests check the assignment of lineage groups to cells based on UMI and intBC data.
- **Character Matrix Formation**: Tests validate the conversion of allele tables to character matrices and lineage profiles, handling conflicts and custom configurations.
- **UMI Collapsing**: Tests ensure that UMIs are correctly collapsed in BAM files, using different methods and handling header information.
- **Configuration Parsing**: Tests verify that configuration files are parsed correctly and that the pipeline is set up as expected.
- **FASTQ to BAM Conversion**: Tests check the conversion of FASTQ files to unmapped BAM format for different sequencing chemistries.
- **Barcode Correction**: Tests validate the correction of cell and integer barcodes against a whitelist.
- **BAM Filtering**: Tests ensure that BAM files are filtered correctly based on specified thresholds.
- **Molecule Table Filtering**: Tests check the filtering and processing of molecular data tables.
- **UMI Resolution**: Tests verify the correct resolution and filtering of UMIs based on specified criteria.

These tests are crucial for ensuring the reliability and accuracy of the preprocessing steps in the Cassiopeia pipeline, which is essential for downstream phylogenetic analysis.