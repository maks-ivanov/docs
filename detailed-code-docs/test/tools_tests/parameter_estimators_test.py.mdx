---
title: "parameter_estimators_test.py"
---

## High-level description

The target file `parameter_estimators_test.py` is a unit test suite for testing the functionality of parameter estimation methods in the `cassiopeia.tools.parameter_estimators` module. It uses the `unittest` framework to verify the correctness of functions that estimate mutation rates and missing data rates in phylogenetic trees represented by the `CassiopeiaTree` class. The tests cover both discrete and continuous models of mutation and missing data estimation.

## Code Structure

The main class in this file is `TestCassiopeiaTree`, which inherits from `unittest.TestCase`. This class contains several test methods that validate the behavior of functions from the `parameter_estimators` module. The tests are organized into methods that test specific functionalities, such as mutation rate estimation and missing data rate estimation. The `setUp` method initializes test data, including small phylogenetic trees and character matrices, which are used across multiple test cases.

## References

The test file references the following components from the codebase:
- `cassiopeia.tools.parameter_estimators`: The module containing the functions being tested.
- `cassiopeia.data.CassiopeiaTree`: The class used to represent phylogenetic trees and character matrices.
- `cassiopeia.mixins.ParameterEstimateError` and `cassiopeia.mixins.ParameterEstimateWarning`: Custom exceptions and warnings used in the parameter estimation functions.

## Symbols

### `TestCassiopeiaTree`
#### Description
This class contains unit tests for the parameter estimation functions in the `cassiopeia.tools.parameter_estimators` module. It tests the correctness of mutation rate and missing data rate estimations using both discrete and continuous models.

#### Inputs
- None directly, but it uses initialized data structures like `CassiopeiaTree` instances with specific character matrices and priors.

#### Outputs
- None directly, but it asserts expected outcomes using the `unittest` framework.

#### Internal Logic
- **`setUp` Method**: Initializes two `CassiopeiaTree` instances (`discrete_tree` and `continuous_tree`) with predefined network structures and character matrices. These trees are used in the test methods to verify the parameter estimation functions.
- **`test_proportions` Method**: Tests the `get_proportion_of_mutation` and `get_proportion_of_missing_data` functions for both discrete and continuous trees, asserting the expected proportions.
- **`test_estimate_mutation_rate` Method**: Tests the `estimate_mutation_rate` function for both discrete and continuous models, with and without assuming an implicit root branch, asserting the expected mutation rates.
- **`test_estimate_missing_data_bad_cases` Method**: Tests the `estimate_missing_data_rates` function for scenarios expected to raise `ParameterEstimateError` or `ParameterEstimateWarning`.
- **`test_estimate_stochastic_missing_data_probability` Method**: Tests the estimation of stochastic missing data probability, asserting the expected values.
- **`test_estimate_heritable_missing_data_rate` Method**: Tests the estimation of heritable missing data rate, asserting the expected values.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `unittest` | Provides the testing framework for writing and running tests. |
| `networkx` | Used to create and manipulate the directed graph structure of the phylogenetic trees. |
| `numpy` | Used for numerical operations and assertions involving floating-point comparisons. |
| `pandas` | Used to create and manipulate the character matrices as DataFrames. |
| `cassiopeia` | The main library being tested, specifically its `tools` and `data` modules. |

## Error Handling

The test methods expect certain functions to raise `ParameterEstimateError` or `ParameterEstimateWarning` under specific conditions, which are verified using `unittest`'s `assertRaises` context manager.

## Logging

No explicit logging is implemented in this test file. The `unittest` framework handles test results and outputs.

## TODOs

No TODOs or notes are present in the code.