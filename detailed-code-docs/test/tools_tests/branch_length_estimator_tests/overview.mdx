---
title: "Overview"
---

## High-level description

The `branch_length_estimator_tests` directory contains unit test suites for validating the functionality of branch length estimators within the `cassiopeia.tools` module. These estimators are designed to model the evolution of phylogenetic trees, specifically focusing on the estimation of branch lengths using different statistical approaches. The directory includes tests for two main classes: `IIDExponentialBayesian` and `IIDExponentialMLE`. The `IIDExponentialBayesian` class uses a Bayesian approach with an IID exponential model, while the `IIDExponentialMLE` class employs a maximum likelihood estimation (MLE) approach. The tests ensure that these models accurately compute likelihoods, posterior distributions, and branch lengths under various scenarios.

## What does it do?

The test suites in this directory are designed to verify the accuracy and robustness of branch length estimators used in phylogenetic analysis. These estimators are crucial for understanding the evolutionary relationships and mutation rates in phylogenetic trees, which are often used in biological research to trace lineage and evolutionary history.

- **IIDExponentialBayesian Tests**: These tests validate the Bayesian branch length estimator by comparing its output against known solutions and numerical approximations. The tests check the model's ability to compute the likelihood of observed data, the posterior distribution of node times, and the overall joint probability of the tree's structure and character states.

- **IIDExponentialMLE Tests**: These tests focus on the maximum likelihood estimator, ensuring it can handle various tree topologies and character state configurations. The tests include scenarios with degenerate character matrices and specific hand-solvable problems to ensure the estimator's accuracy and error handling capabilities.

Both test suites use parameterized tests to evaluate the estimators under different configurations and solvers, ensuring consistent behavior across different computational backends.

## Entry points

The directory contains two main test files, each serving as an entry point for testing a specific branch length estimator:

1. **`iid_exponential_bayesian_test.py`**: This file contains tests for the `IIDExponentialBayesian` class. It includes functions and a test class that perform various checks on the Bayesian model's computations.

2. **`iid_exponential_mle_test.py`**: This file includes tests for the `IIDExponentialMLE` class. It features a test class with methods that validate the MLE model's performance under different conditions.

## Dependencies

The test suites rely on several external libraries to perform their functions:

- **`unittest`**: Provides the framework for defining and running the tests.
- **`networkx`**: Used for creating and manipulating the tree structures as directed graphs.
- **`numpy`**: Facilitates numerical computations and operations within the tests.
- **`scipy`**: Offers integration and special functions necessary for numerical approximations.
- **`pytest`**: Utilized for marking slow tests, enhancing test management.
- **`parameterized`**: Allows the test methods to be run with different inputs, ensuring comprehensive coverage of the estimators' behavior.

These dependencies are chosen for their robust support of numerical and graph-based operations, which are essential for the accurate testing of phylogenetic models.