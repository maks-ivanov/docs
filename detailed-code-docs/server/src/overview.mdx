---
title: "Overview"
---

## High-level description
The `server/src` directory contains the core server-side implementation of the Trieve application. It includes various components such as data models, API handlers, middleware, utility functions, and command-line tools for managing the application's backend operations.

## What does it do?
This directory houses the server-side logic for the Trieve application, which appears to be a sophisticated data management and search platform. The server handles various tasks including:

1. User authentication and authorization
2. Data ingestion and processing
3. File uploads and management
4. Search functionality (semantic, full-text, and hybrid)
5. Chat and messaging features
6. Analytics and event tracking
7. Integration with external services (OpenAI, Stripe)
8. Database operations (PostgreSQL, Qdrant vector database, ClickHouse)
9. API versioning and request handling
10. Background workers for tasks like data deletion, file processing, and data synchronization

## Entry points
The main entry points for the server application are:

1. `main.rs`: The primary entry point for the server application.
2. `lib.rs`: Sets up the server configuration, defines API routes, and initializes various services and middleware.
3. `handlers/`: Contains modules for handling different types of API requests (e.g., auth, datasets, chunks, files).
4. `bin/`: Houses command-line utilities for various maintenance and management tasks.

The code is organized into several key directories:

- `data/`: Contains data models and database schema definitions.
- `handlers/`: Implements API request handlers for different resources.
- `middleware/`: Defines custom middleware for request processing.
- `operators/`: Implements core business logic and data operations.
- `public/`: Contains a simple HTML file for client-side authentication.

## Key Files
1. `lib.rs`: Sets up the server configuration and API routes.
2. `main.rs`: The main entry point that delegates to `lib.rs`.
3. `errors.rs`: Defines custom error types and error handling logic.
4. `randutil.rs`: Provides utility functions for generating random names.
5. `handlers/*.rs`: Implement API request handlers for various resources.
6. `operators/*.rs`: Contain core business logic for data operations.
7. `middleware/*.rs`: Define custom middleware for request processing.
8. `data/models.rs` and `data/schema.rs`: Define data structures and database schema.

## Dependencies
The server relies on several key external libraries and frameworks:

- `actix-web`: Web framework for handling HTTP requests and responses.
- `diesel`: ORM for database interactions with PostgreSQL.
- `qdrant_client`: Client for interacting with the Qdrant vector database.
- `redis`: For managing task queues and caching.
- `sentry`: For error logging and monitoring.
- `tokio`: Asynchronous runtime for Rust.
- `tracing`: For logging and instrumentation.
- `utoipa`: For generating OpenAPI documentation.

## Configuration
The server uses environment variables for configuration, including:

- Database connection strings (PostgreSQL, Redis, Qdrant)
- API keys and secrets
- Feature flags (e.g., analytics, Sentry integration)
- Server settings (e.g., cookie security)

Configuration is primarily managed through environment variables, with some constants defined in the code.

## Error Handling
The application uses a custom `ServiceError` type defined in `errors.rs` for consistent error handling across the server. It includes detailed error messages and integrates with Sentry for error logging.

## Logging
The server uses the `tracing` crate for logging and instrumentation, with optional integration with Sentry for error monitoring.

In conclusion, the `server/src` directory contains a comprehensive implementation of a data management and search platform, with features for user management, data processing, search, analytics, and integration with external services. The code is well-organized into modules for different functionalities, making it maintainable and extensible.