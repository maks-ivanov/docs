---
title: "down.sql"
---

## High-level description
This SQL migration script reverts changes made to the `topics` table, replacing the `owner_id` column with the original `user_id` column. It's designed to undo the changes implemented in the corresponding `up.sql` migration.

## Table of contents
- Add `user_id` column
- Update `user_id` with `owner_id` data
- Remove `owner_id` column
- Drop index

## Symbols

### ALTER TABLE topics ADD COLUMN user_id TEXT;
#### Description
This SQL statement adds a new column named `user_id` of type TEXT to the `topics` table.

### UPDATE topics SET user_id = owner_id;
#### Description
This SQL statement copies the data from the `owner_id` column to the newly created `user_id` column for all rows in the `topics` table.

### ALTER TABLE topics DROP COLUMN owner_id;
#### Description
This SQL statement removes the `owner_id` column from the `topics` table.

### DROP INDEX IF EXISTS "topics_dataset_id_owner_id_idx";
#### Description
This SQL statement removes the index named "topics_dataset_id_owner_id_idx" if it exists. This index was likely created in the corresponding `up.sql` migration.

## Side Effects
- The structure of the `topics` table is modified.
- Data is transferred from `owner_id` to `user_id`.
- An index is potentially removed.

## Future Improvements
- Consider adding a NOT NULL constraint to the `user_id` column if it's required.
- If foreign key constraints were involved, they might need to be re-established for the `user_id` column.
- Depending on the application's needs, recreating an index on `user_id` might be beneficial for query performance.