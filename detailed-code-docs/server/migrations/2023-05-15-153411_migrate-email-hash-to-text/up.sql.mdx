---
title: "up.sql"
---

## High-level description
This SQL migration script alters the `users` table, changing the data types of the `email` and `hash` columns from their current types to TEXT.

## Table of contents
- ALTER TABLE statement
  - Modify email column
  - Modify hash column

## Symbols

### ALTER TABLE users
#### Description
This SQL command modifies the structure of the `users` table.

#### Internal Logic
1. Targets the `users` table for modification.
2. Changes the data type of the `email` column to TEXT.
3. Changes the data type of the `hash` column to TEXT.

### ALTER COLUMN email TYPE TEXT
#### Description
This clause changes the data type of the `email` column to TEXT.

### ALTER COLUMN hash TYPE TEXT
#### Description
This clause changes the data type of the `hash` column to TEXT.

## Side Effects
- The data types of the `email` and `hash` columns in the `users` table will be changed to TEXT.
- Existing data in these columns will be automatically converted to the new TEXT type if possible.
- If the previous data types were incompatible with TEXT, this migration might fail or cause data loss.

## Performance Considerations
- Changing column types on large tables can be a time-consuming operation and may lock the table during the process.
- The TEXT data type in PostgreSQL has no length limit, which might impact storage and query performance compared to fixed-length types.

## Future Improvements
- Consider adding appropriate constraints (e.g., NOT NULL, unique constraints) if they were present on the original columns and not automatically carried over.
- If email validation is required, consider implementing it at the application level or using CHECK constraints.
- For the `hash` column, ensure that the new TEXT type provides sufficient space for the hash algorithm being used.