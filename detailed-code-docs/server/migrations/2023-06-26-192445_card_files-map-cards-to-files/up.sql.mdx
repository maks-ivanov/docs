---
title: "up.sql"
---

## High-level description
This SQL script creates a new table named `card_files` to establish a many-to-many relationship between cards and files in the database. It defines the structure of the table with primary and foreign keys, as well as timestamp fields for tracking creation and update times.

## Table of contents
- Table creation
- Column definitions
- Primary key
- Foreign key references
- Default timestamp values

## Symbols

### `card_files` table
#### Description
The `card_files` table is created to map cards to files, allowing for a many-to-many relationship between the `card_metadata` and `files` tables.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| id | uuid | Unique identifier for each card-file association |
| card_id | uuid | Foreign key referencing the `card_metadata` table |
| file_id | uuid | Foreign key referencing the `files` table |
| created_at | timestamp | Timestamp of when the association was created |
| updated_at | timestamp | Timestamp of when the association was last updated |

#### Internal Logic
1. The table is created with a primary key `id` of type `uuid`.
2. Two foreign key columns, `card_id` and `file_id`, are defined to reference the `card_metadata` and `files` tables, respectively.
3. Timestamp columns `created_at` and `updated_at` are added with default values set to the current time using `NOW()`.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| card_metadata | Referenced by the `card_id` foreign key |
| files | Referenced by the `file_id` foreign key |

## Future Improvements
- Consider adding a unique constraint on the combination of `card_id` and `file_id` to prevent duplicate associations.
- Depending on the application requirements, you might want to add indexes on `card_id` and `file_id` columns to improve query performance when searching for associations.
- If needed, you could add additional metadata columns to store information about the relationship between cards and files.