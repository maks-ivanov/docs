---
title: "Overview"
---

## High-level description
This directory contains SQL migration scripts for adding a new `chunk_count` column to the `organization_usage_counts` table. The `up.sql` script handles the addition of the column and the initial calculation of chunk counts, while the `down.sql` script reverts these changes.

## What does it do?
These scripts modify the database schema to track the total number of chunks used by each organization. The `up.sql` script adds a new column to store this information and calculates the initial values by aggregating data from the `dataset_usage_counts` table. The `down.sql` script simply removes the added column. This allows for tracking and managing chunk usage at the organization level.

## Key Files
- **up.sql:** This script is responsible for applying the migration. It adds the `chunk_count` column to the `organization_usage_counts` table, calculates the aggregate chunk counts from the `dataset_usage_counts` table, and updates the `organization_usage_counts` table with the calculated values.
- **down.sql:** This script reverts the changes made by `up.sql`. It removes the `chunk_count` column from the `organization_usage_counts` table, effectively rolling back the database schema to its previous state. 
