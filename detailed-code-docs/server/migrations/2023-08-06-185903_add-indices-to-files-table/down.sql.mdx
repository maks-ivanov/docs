---
title: "down.sql"
---

## High-level description
This SQL script is designed to undo the creation of indices on the 'files' and 'card_files' tables. It's a migration rollback script that removes performance-enhancing database indices, potentially reverting the database schema to a previous state.

## Table of contents
- Removing indices from 'files' table
- Removing indices from 'card_files' table

## Symbols

### DROP INDEX IF EXISTS idx_files_user_id
#### Description
Removes the index on the 'user_id' column of the 'files' table if it exists.

### DROP INDEX IF EXISTS idx_files_private
#### Description
Removes the index on the 'private' column of the 'files' table if it exists.

### DROP INDEX IF EXISTS idx_files_created_at
#### Description
Removes the index on the 'created_at' column of the 'files' table if it exists.

### DROP INDEX IF EXISTS idx_files_updated_at
#### Description
Removes the index on the 'updated_at' column of the 'files' table if it exists.

### DROP INDEX IF EXISTS idx_card_files_card_id
#### Description
Removes the index on the 'card_id' column of the 'card_files' table if it exists.

### DROP INDEX IF EXISTS idx_card_files_file_id
#### Description
Removes the index on the 'file_id' column of the 'card_files' table if it exists.

### DROP INDEX IF EXISTS idx_card_files_created_at
#### Description
Removes the index on the 'created_at' column of the 'card_files' table if it exists.

### DROP INDEX IF EXISTS idx_card_files_updated_at
#### Description
Removes the index on the 'updated_at' column of the 'card_files' table if it exists.

## Side Effects
- Removing these indices may impact query performance on the 'files' and 'card_files' tables.
- Queries that were previously optimized to use these indices may become slower.
- The database size might slightly decrease due to the removal of index structures.

## Performance Considerations
- After running this script, queries involving the affected columns (user_id, private, created_at, updated_at in 'files' table; card_id, file_id, created_at, updated_at in 'card_files' table) may experience reduced performance.
- The impact on performance will depend on the size of the tables and the frequency of queries using these columns.

## Future Improvements
- Consider adding a comment explaining why these indices were removed and under what circumstances they might need to be recreated.
- If these indices are frequently added and removed, consider creating a separate migration script for index management to allow more granular control.
- Evaluate the performance impact of removing these indices and document it for future reference.