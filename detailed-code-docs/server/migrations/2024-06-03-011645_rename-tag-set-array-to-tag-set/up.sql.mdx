---
title: "up.sql"
---

## High-level description
This SQL migration script renames the `tag_set_array` column to `tag_set` in three tables: `chunk_metadata`, `files`, and `chunk_group`. It also drops the existing `tag_set` column from these tables.

## Table of contents
- Modify `chunk_metadata` table
- Modify `files` table
- Modify `chunk_group` table

## Symbols

### ALTER TABLE chunk_metadata
#### Description
This set of SQL commands modifies the `chunk_metadata` table by dropping the `tag_set` column and renaming `tag_set_array` to `tag_set`.

#### Internal Logic
1. Drop the existing `tag_set` column
2. Rename `tag_set_array` to `tag_set`

### ALTER TABLE files
#### Description
This set of SQL commands modifies the `files` table by dropping the `tag_set` column and renaming `tag_set_array` to `tag_set`.

#### Internal Logic
1. Drop the existing `tag_set` column
2. Rename `tag_set_array` to `tag_set`

### ALTER TABLE chunk_group
#### Description
This set of SQL commands modifies the `chunk_group` table by dropping the `tag_set` column and renaming `tag_set_array` to `tag_set`.

#### Internal Logic
1. Drop the existing `tag_set` column
2. Rename `tag_set_array` to `tag_set`

## Side Effects
- The `tag_set` column is permanently removed from all three tables.
- The `tag_set_array` column is renamed to `tag_set` in all three tables.
- Any existing data in the original `tag_set` columns will be lost.
- Any queries or application code referencing the old column names will need to be updated.

## Future Improvements
- Consider creating a backup of the `tag_set` column data before dropping it, if the data is still needed.
- Ensure that all application code and queries are updated to use the new column name `tag_set` instead of `tag_set_array`.
- If there are any foreign key constraints or indexes on the renamed columns, they may need to be recreated or updated in a separate migration.