---
title: "up.sql"
---

## High-level description
This SQL migration script adds a soft delete functionality to the organizations table by introducing a 'deleted' column and creating an index on it for improved query performance.

## Table of contents
- Add 'deleted' column to organizations table
- Create index on 'deleted' column

## Symbols

### ALTER TABLE organizations
#### Description
This SQL command modifies the structure of the 'organizations' table by adding a new column named 'deleted'.

#### Internal Logic
- Adds a new column 'deleted' to the 'organizations' table
- Sets the data type of the column to INT
- Sets a default value of 0 for the column
- Makes the column NOT NULL, ensuring it always has a value

### CREATE INDEX IF NOT EXISTS idx_organization_deleted
#### Description
This SQL command creates an index on the newly added 'deleted' column to optimize queries that filter on this column.

#### Internal Logic
- Creates an index named 'idx_organization_deleted' if it doesn't already exist
- The index is created on the 'deleted' column of the 'organizations' table

## Performance Considerations
The addition of the index on the 'deleted' column will improve the performance of queries that filter organizations based on their deletion status. This is particularly beneficial for large tables where frequent queries on the 'deleted' column are expected.

## Future Improvements
- Consider adding a timestamp column (e.g., 'deleted_at') to store when the soft delete occurred, providing more detailed information about the deletion.
- If the organization table is expected to have a large number of soft-deleted records, consider partitioning the table based on the 'deleted' column for further performance improvements.