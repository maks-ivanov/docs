---
title: "Overview"
---

## High-level description
This directory contains SQL migration scripts for implementing soft delete functionality for the `organizations` table. The scripts introduce a `deleted` column to the table and create an index on it for efficient querying.

## What does it do?
The migration scripts in this directory modify the database schema to allow for "soft deleting" organizations. Instead of permanently removing organization records from the database, a new `deleted` column is added to the `organizations` table. When an organization is "deleted," this column is set to 1, effectively hiding it from normal queries. The scripts also create an index on the `deleted` column to speed up queries that filter based on deletion status. This approach preserves data integrity and allows for potential data recovery if needed.

## Key Files
- **up.sql:** This script is responsible for applying the migration. It adds the `deleted` column to the `organizations` table and creates the index.
  ```sql
  ALTER TABLE organizations
    ADD COLUMN deleted INT DEFAULT 0 NOT NULL;

  CREATE INDEX IF NOT EXISTS idx_organization_deleted
    ON organizations (deleted);
  ```
- **down.sql:** This script reverts the changes made by `up.sql`. It removes the `deleted` column and drops the associated index.
  ```sql
  ALTER TABLE organizations DROP COLUMN IF EXISTS deleted;

  DROP INDEX IF EXISTS idx_organization_deleted;
  ```
