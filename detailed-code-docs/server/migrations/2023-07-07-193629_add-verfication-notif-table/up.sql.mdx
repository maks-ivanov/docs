---
title: "up.sql"
---

## High-level description
This SQL script creates a new table named `verification_notifications` in the database. The table is designed to store information about card verification notifications, including references to users, cards, and verification records, along with a similarity score and read status.

## Table of contents
- Table creation
- Column definitions
- Foreign key references
- Default values

## Symbols

### `verification_notifications` table
#### Description
This table is created to store notifications related to card verifications. It includes information about the user, the card, the verification record, a similarity score, and whether the user has read the notification.

#### Columns
| Name | Type | Description |
|:-----|:-----|:------------|
| id | UUID | Primary key for the table |
| user_uuid | UUID | Foreign key referencing the users table |
| card_uuid | UUID | Foreign key referencing the card_metadata table |
| verification_uuid | UUID | Foreign key referencing the card_verification table |
| similarity_score | BigInt | A score representing the similarity (likely between the card and some reference) |
| user_read | boolean | Indicates whether the user has read the notification |
| created_at | TIMESTAMP | Timestamp of when the record was created |
| updated_at | TIMESTAMP | Timestamp of when the record was last updated |

#### Internal Logic
1. The table uses UUID as the primary key for the `id` column.
2. Foreign key constraints are established for `user_uuid`, `card_uuid`, and `verification_uuid` columns, referencing the `users`, `card_metadata`, and `card_verification` tables respectively.
3. The `similarity_score` is stored as a BigInt, suggesting it might be a large numerical value.
4. The `user_read` column has a default value of false, indicating that new notifications are unread by default.
5. Both `created_at` and `updated_at` columns have a default value of the current timestamp (`NOW()`).

## Dependencies
This migration script depends on the existence of the following tables:
| Dependency | Purpose |
|:-----------|:--------|
| users | Referenced by user_uuid foreign key |
| card_metadata | Referenced by card_uuid foreign key |
| card_verification | Referenced by verification_uuid foreign key |

## Future Improvements
- Consider adding an index on the `user_uuid` column if queries frequently filter or join on this column.
- If the `similarity_score` doesn't require such a large range of values, consider using a smaller integer type or a floating-point type for more precise scores.
- Depending on the application's needs, consider adding an index on the `created_at` column if notifications are frequently queried based on their creation time.