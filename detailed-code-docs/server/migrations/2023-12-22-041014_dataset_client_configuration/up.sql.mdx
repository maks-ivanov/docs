---
title: "up.sql"
---

## High-level description
This SQL migration script modifies the `datasets` table by renaming the `configuration` column to `server_configuration` and adding a new `client_configuration` column with a JSON data type.

## Table of contents
- Rename `configuration` column
- Add `client_configuration` column

## Code Structure
The migration consists of two SQL ALTER TABLE statements executed sequentially on the `datasets` table.

## Symbols

### ALTER TABLE datasets RENAME COLUMN
#### Description
This statement renames the existing `configuration` column in the `datasets` table to `server_configuration`.

#### Internal Logic
The existing column `configuration` is renamed to `server_configuration` without changing its data type or content.

### ALTER TABLE datasets ADD COLUMN
#### Description
This statement adds a new column named `client_configuration` to the `datasets` table.

#### Internal Logic
- Adds a new column named `client_configuration`
- Sets the data type to JSONB (binary JSON)
- Makes the column NOT NULL
- Sets a default value of an empty JSON object (`'{}'`)

## Side Effects
- The existing `configuration` column will no longer be accessible under that name; it must be referred to as `server_configuration`.
- Any queries or application code referencing the old `configuration` column will need to be updated.
- All existing rows in the `datasets` table will have a new `client_configuration` column with an empty JSON object as the value.

## Future Improvements
- Consider adding a migration script to populate the `client_configuration` column with meaningful data if required.
- Ensure that any application code or queries are updated to use the new column names and structure.
- If the `server_configuration` column is no longer needed, a future migration could potentially remove it after ensuring all necessary data has been migrated or is no longer required.