---
title: "Overview"
---

## High-level description
This directory contains SQL migration scripts for managing a table called `card_metadata_counts`. This table stores the total count of card metadata rows for each dataset in the system. The scripts handle both the creation and removal of the table and its associated triggers and functions.

## What does it do?
The SQL scripts in this directory manage the lifecycle of a database table responsible for tracking the number of metadata entries associated with each dataset. 

The `up.sql` script creates the `card_metadata_counts` table. Each row in this table corresponds to a dataset and stores the total count of metadata entries linked to that dataset. To keep this count accurate, a trigger function (`update_card_metadata_count()`) is also defined. This function automatically updates the count in the `card_metadata_counts` table whenever a new metadata entry is added or removed for a dataset.

Conversely, the `down.sql` script undoes these changes. It removes the trigger, the function, and finally, the `card_metadata_counts` table itself. This ensures that the database schema can be reverted to its previous state if needed. 
