---
title: "down.sql"
---

## High-level description
This SQL script is designed to revert changes made to the `card_metadata` table, specifically removing a GiST index and its associated column. It's part of a database migration system, serving as the 'down' migration to undo the corresponding 'up' migration.

## Table of contents
- Remove GiST index
- Remove tsvector column

## Symbols

### DROP INDEX IF EXISTS idx_card_metadata_tsvector
#### Description
This SQL command removes the GiST index named `idx_card_metadata_tsvector` if it exists in the database.

#### Inputs
None

#### Outputs
None

#### Internal Logic
The `IF EXISTS` clause ensures that the command doesn't throw an error if the index doesn't exist.

### ALTER TABLE card_metadata DROP COLUMN IF EXISTS card_metadata_tsvector
#### Description
This SQL command removes the column `card_metadata_tsvector` from the `card_metadata` table if it exists.

#### Inputs
None

#### Outputs
None

#### Internal Logic
The `IF EXISTS` clause ensures that the command doesn't throw an error if the column doesn't exist.

## Side Effects
- Removes the GiST index `idx_card_metadata_tsvector`, which may impact query performance for full-text searches on the `card_metadata` table.
- Removes the `card_metadata_tsvector` column from the `card_metadata` table, which may contain pre-computed tsvector data for full-text search functionality.

## Future Improvements
- Consider adding a check to verify if the table `card_metadata` exists before attempting to alter it.
- If this migration is part of a larger system, consider implementing a way to track and log the execution of these migrations for better maintainability and debugging.