---
title: "up.sql"
---

## High-level description
This SQL migration script modifies the `chunk_metadata` table by removing the existing `location` column and adding a new `location` column of type JSONB with a default value of NULL.

## Table of contents
- Drop existing `location` column
- Add new `location` column

## Symbols

### ALTER TABLE chunk_metadata DROP COLUMN IF EXISTS location
#### Description
This SQL command removes the `location` column from the `chunk_metadata` table if it exists.

#### Internal Logic
- The `IF EXISTS` clause ensures that the command doesn't throw an error if the column doesn't exist.
- This step is likely performed to ensure a clean slate before adding the new column.

### ALTER TABLE chunk_metadata ADD COLUMN location JSONB DEFAULT NULL
#### Description
This SQL command adds a new `location` column to the `chunk_metadata` table with the JSONB data type and a default value of NULL.

#### Internal Logic
- The new column is named `location`.
- It uses the JSONB data type, which allows for storing JSON data in a binary format for improved performance and querying capabilities.
- The `DEFAULT NULL` clause sets the default value of this column to NULL, meaning if no value is specified when inserting a new row, it will be NULL.

## Future Improvements
- Consider adding a comment to the migration file explaining the reason for this change, such as why the `location` column is being changed to JSONB and why NULL is now allowed as a default value.
- If there's existing data in the old `location` column, consider adding a data migration step to transfer and transform the data to the new JSONB format.
- Depending on the application's needs, consider adding any necessary indexes on the new JSONB column to optimize query performance.