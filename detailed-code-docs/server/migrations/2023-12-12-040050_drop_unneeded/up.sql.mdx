---
title: "up.sql"
---

## High-level description
This SQL migration script removes several database objects that are no longer needed in the system. It drops a column, two tables, a trigger, and a function, effectively cleaning up the database schema.

## Table of contents
- Alter table `card_metadata`
- Drop table `invitations`
- Drop table `password_resets`
- Drop trigger `update_tsvector_trigger`
- Drop function `update_tsvector()`

## Symbols

### ALTER TABLE card_metadata
#### Description
This command removes the `card_metadata_tsvector` column from the `card_metadata` table if it exists.

#### Internal Logic
The `DROP COLUMN IF EXISTS` clause ensures that the operation is safe to run even if the column has already been removed.

### DROP TABLE IF EXISTS invitations
#### Description
This command removes the `invitations` table from the database if it exists.

### DROP TABLE IF EXISTS password_resets
#### Description
This command removes the `password_resets` table from the database if it exists.

### DROP TRIGGER IF EXISTS update_tsvector_trigger ON card_metadata
#### Description
This command removes the `update_tsvector_trigger` trigger from the `card_metadata` table if it exists.

### DROP FUNCTION IF EXISTS update_tsvector()
#### Description
This command removes the `update_tsvector()` function from the database if it exists.

## Side Effects
- Permanent removal of the `card_metadata_tsvector` column from the `card_metadata` table
- Permanent removal of the `invitations` table and all its data
- Permanent removal of the `password_resets` table and all its data
- Removal of the `update_tsvector_trigger` trigger from the `card_metadata` table
- Removal of the `update_tsvector()` function from the database

## Future Improvements
- Consider adding comments to explain why these database objects are being removed
- If these objects are being replaced by new ones, consider adding the creation of new objects in this migration or in a separate migration file
- Ensure that any application code relying on these database objects is updated accordingly to prevent errors