---
title: "down.sql"
---

## High-level description
This SQL migration script is designed to revert changes made to the `user_api_key` table, specifically undoing modifications related to API key hashing and storage.

## Table of contents
- Alter `api_key_hash` column
- Drop `blake3_hash` column

## Code Structure
The script contains two SQL statements that modify the `user_api_key` table structure:
1. Alters the `api_key_hash` column
2. Drops the `blake3_hash` column

## Symbols

### ALTER TABLE user_api_key ALTER COLUMN api_key_hash SET NOT NULL
#### Description
This statement modifies the `api_key_hash` column in the `user_api_key` table, setting it to NOT NULL.

#### Internal Logic
- Targets the `user_api_key` table
- Modifies the `api_key_hash` column
- Sets the column constraint to NOT NULL

### ALTER TABLE user_api_key DROP COLUMN blake3_hash
#### Description
This statement removes the `blake3_hash` column from the `user_api_key` table.

#### Internal Logic
- Targets the `user_api_key` table
- Drops the `blake3_hash` column

## Future Improvements
- Consider adding comments to explain the reason for these changes, especially if the migration is part of a larger feature or optimization effort.
- If there's data in the `blake3_hash` column that needs to be preserved or migrated, consider adding steps to handle that before dropping the column.