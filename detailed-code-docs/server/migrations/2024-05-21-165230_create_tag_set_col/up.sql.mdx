---
title: "up.sql"
---

## High-level description
This SQL migration script adds a new column named `tag_set_array` to three existing tables: `chunk_metadata`, `chunk_group`, and `files`. The new column is designed to store an array of text values, with a default empty array.

## Table of contents
- Add `tag_set_array` column to `chunk_metadata` table
- Add `tag_set_array` column to `chunk_group` table
- Add `tag_set_array` column to `files` table

## Symbols

### ALTER TABLE chunk_metadata
#### Description
This SQL command adds a new column `tag_set_array` to the `chunk_metadata` table.

#### Internal Logic
- Adds a column named `tag_set_array`
- Sets the data type to `TEXT[]` (an array of text values)
- Sets the default value to an empty array `'{}'`

### ALTER TABLE chunk_group
#### Description
This SQL command adds a new column `tag_set_array` to the `chunk_group` table.

#### Internal Logic
- Adds a column named `tag_set_array`
- Sets the data type to `TEXT[]` (an array of text values)
- Sets the default value to an empty array `'{}'`

### ALTER TABLE files
#### Description
This SQL command adds a new column `tag_set_array` to the `files` table.

#### Internal Logic
- Adds a column named `tag_set_array`
- Sets the data type to `TEXT[]` (an array of text values)
- Sets the default value to an empty array `'{}'`

## Side Effects
- Modifies the schema of three existing tables: `chunk_metadata`, `chunk_group`, and `files`
- Existing rows in these tables will have the new `tag_set_array` column populated with an empty array

## Future Improvements
- Consider adding an index on the `tag_set_array` column if it will be frequently used in queries
- If the tags have a predefined set of values, consider using an ENUM type instead of TEXT for better data integrity
- Implement a down migration script to revert these changes if needed