---
title: "types.py"
---

## High-level description

The `marimo/_messaging/types.py` file defines types and abstract base classes for handling messages and streams in a kernel environment. It provides a structure for writing messages to different output streams like `stdout`, `stderr`, and `stdin`, and includes a no-operation stream for cases where no output is needed.

## Code Structure

The main symbols in the code are interconnected as follows:
- `KernelMessage` is a type alias for a tuple representing messages from the kernel.
- `Stream` is an abstract base class that defines a contract for writing messages.
- `NoopStream` is a concrete implementation of `Stream` that performs no operations.
- `Stdout`, `Stderr`, and `Stdin` are classes inheriting from `io.TextIOBase`, each representing a standard I/O stream with specific methods for writing data with a known MIME type.

## Symbols

### `KernelMessage`
#### Description
A type alias for a tuple that represents a message from the kernel, consisting of a message type and a JSON representation of the message.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| str | str | The type of the message. |
| Any | Any | The JSON representation of the message. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Tuple[str, Any] | Tuple | A tuple containing the message type and its JSON representation. |

___

### `Stream`
#### Description
An abstract base class that defines a contract for writing messages from the kernel to some output. It includes an optional `cell_id` attribute and an abstract `write` method.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| op | str | The operation or message type. |
| data | Dict[Any, Any] | The data associated with the message. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | None | This method does not return a value. |

#### Internal Logic
The `write` method is abstract and must be implemented by subclasses to define how messages are written to the output.

___

### `NoopStream`
#### Description
A concrete implementation of the `Stream` class that performs no operations. It is used when no output is needed.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| op | str | The operation or message type. |
| data | Dict[Any, Any] | The data associated with the message. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | None | This method does not return a value. |

#### Internal Logic
The `write` method is implemented to do nothing, effectively ignoring any messages passed to it.

___

### `Stdout`
#### Description
Represents the standard output stream, inheriting from `io.TextIOBase`. It includes a method for writing data with a specified MIME type.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| __s | str | The string data to be written to the output. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| int | int | The number of characters written. |

#### Internal Logic
The `write` method calls `_write_with_mimetype` with the data and a default MIME type of "text/plain".

___

### `Stderr`
#### Description
Represents the standard error stream, similar to `Stdout`, but for error messages.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| __s | str | The string data to be written to the error output. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| int | int | The number of characters written. |

#### Internal Logic
The `write` method calls `_write_with_mimetype` with the data and a default MIME type of "text/plain".

___

### `Stdin`
#### Description
Represents the standard input stream, inheriting from `io.TextIOBase`. It is currently a placeholder with no additional functionality.

#### Inputs
None

#### Outputs
None

___

## References

- `CellId_t` from `marimo._ast.cell` is used as a type for the optional `cell_id` attribute in the `Stream` class.
- `KnownMimeType` from `marimo._messaging.mimetypes` is used to specify MIME types in the `Stdout` and `Stderr` classes.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `abc` | Provides the `ABC` class for defining abstract base classes. |
| `io` | Provides the `TextIOBase` class for I/O stream handling. |
| `typing` | Provides type hints and aliases for better code clarity and type checking. |

## Error Handling

The code does not implement specific error handling mechanisms beyond basic exception raising, as it primarily defines abstract and base classes.

## Logging

The code does not implement any logging mechanisms.