---
title: "anywidget_formatters.py"
---

## High-level description

The `AnyWidgetFormatter` class in the `anywidget_formatters.py` file is a specialized formatter for the `anywidget` package. It extends the `FormatterFactory` abstract base class to provide a mechanism for registering a formatter that converts `AnyWidget` instances into a MIME type and string representation, which can be used for rendering in a media viewer.

## Code Structure

- `AnyWidgetFormatter` is a subclass of `FormatterFactory`.
- It uses the `from_anywidget` function from the `marimo._plugins.ui._impl.from_anywidget` module to convert `AnyWidget` instances into a format suitable for rendering.
- The `register` method is used to register the formatter with the `formatting` module, specifically for the `AnyWidget` type.

## References

- `KnownMimeType` from `marimo._messaging.mimetypes` is used to specify the MIME type of the formatted output.
- `FormatterFactory` from `marimo._output.formatters.formatter_factory` is the base class that `AnyWidgetFormatter` extends.
- `from_anywidget` from `marimo._plugins.ui._impl.from_anywidget` is used to convert `AnyWidget` instances into a format that can be rendered.

## Symbols

### `AnyWidgetFormatter`
#### Description
The `AnyWidgetFormatter` class is a formatter for the `anywidget` package. It provides a mechanism to register a formatter that converts `AnyWidget` instances into a MIME type and string representation for rendering.

#### Inputs
- None directly, but it operates on `AnyWidget` instances when the formatter is applied.

#### Outputs
- The formatter function returns a tuple containing a `KnownMimeType` and a string representation of the `AnyWidget`.

#### Internal Logic
- The `package_name` method returns the string "anywidget", indicating the package this formatter is associated with.
- The `register` method imports the `anywidget` package and uses the `formatting.formatter` decorator to register a formatter function for `AnyWidget` instances. This function uses `from_anywidget` to convert the widget into a MIME type and string representation.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `anywidget` | The package for which this formatter is designed. |
| `marimo._messaging.mimetypes.KnownMimeType` | Provides a set of known MIME types for the formatter output. |
| `marimo._output.formatters.formatter_factory.FormatterFactory` | The base class for creating formatters. |
| `marimo._plugins.ui._impl.from_anywidget.from_anywidget` | Converts `AnyWidget` instances into a format suitable for rendering. |

## Error Handling

The code does not explicitly handle errors within the `register` method, but it assumes that the `anywidget` package is available when the method is called. If the package is not found, it would raise an import error.

## Logging

No logging mechanisms are implemented in this code.

## TODOs

There are no TODOs or notes left in the code.