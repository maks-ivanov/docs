---
title: "exiting.py"
---

## High-level description
The code in `marimo/_utils/exiting.py` is designed to manage and track the state of a Python script's exit process. It uses the `atexit` module to register a function that sets a flag indicating that the Python interpreter is in the process of exiting, allowing other parts of the program to check this state and perform any necessary cleanup or final actions.

## Code Structure
The main components of this code are the `Exiting` dataclass, the `_PYTHON_EXITING` instance, the `python_exiting` function, and the `_exit` function. The `Exiting` dataclass is used to encapsulate the exit state, `_PYTHON_EXITING` is a global instance of `Exiting`, `python_exiting` is a function that returns the current exit state, and `_exit` is a function that sets the exit state to `True` when the program is exiting.

## Symbols

### `Exiting`
#### Description
The `Exiting` class is a simple dataclass that holds a boolean value indicating whether the Python interpreter is in the process of exiting.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| value | bool | A flag indicating the exit state of the Python interpreter. Defaults to `False`. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| N/A | N/A | N/A |

### `_PYTHON_EXITING`
#### Description
`_PYTHON_EXITING` is a global instance of the `Exiting` dataclass. It is used to track the exit state of the Python interpreter.

### `python_exiting`
#### Description
The `python_exiting` function checks and returns the current exit state of the Python interpreter by accessing the `value` attribute of the `_PYTHON_EXITING` instance.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| _exiting | Exiting | An instance of the `Exiting` class, defaulting to `_PYTHON_EXITING`. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| exit_state | bool | The current exit state of the Python interpreter. |

### `_exit`
#### Description
The `_exit` function sets the `value` attribute of the `_PYTHON_EXITING` instance to `True`, indicating that the Python interpreter is in the process of exiting.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| N/A | N/A | N/A |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| N/A | N/A | N/A |

## Side Effects
- The `_exit` function modifies the global `_PYTHON_EXITING` instance by setting its `value` attribute to `True`.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| `atexit` | Used to register the `_exit` function to be called upon program termination. |
| `dataclasses` | Provides the `dataclass` decorator to simplify the creation of the `Exiting` class. |

## Error Handling
There is no explicit error handling in this code, as it primarily deals with setting and checking a boolean flag.

## Logging
There is no logging implemented in this code.

## TODOs
There are no TODOs or notes left in the code.