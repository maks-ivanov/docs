---
title: "tree.py"
---

## High-level description

The `tree` function in the `marimo/_plugins/stateless/tree.py` file is designed to render a nested structure of lists, tuples, or dictionaries as a tree in HTML format. It takes a nested data structure and an optional label, formats the structure to handle potential cyclic references, and outputs it as an HTML element using the `json_output` function.

## Code Structure

The main function in this file is `tree`, which utilizes several imported modules and functions to achieve its functionality. It relies on `format_structure` to format the input data and `json_output` to convert the formatted data into an HTML representation. The function also handles cyclic structures using the `CyclicStructureError` from the `flatten` utility.

## References

- `format_structure`: Used to format the input data structure.
- `json_output`: Converts the formatted data into an HTML representation.
- `CyclicStructureError`: Handles cyclic references in the input data.

## Symbols

### `tree`
#### Description
The `tree` function renders a nested structure of lists, tuples, or dictionaries as a tree in HTML format. It ensures that the input data is properly formatted and handles cyclic structures gracefully.

#### Inputs
| Name  | Type                      | Description                                      |
|:------|:--------------------------|:-------------------------------------------------|
| items | `list[Any]`, `tuple[Any]`, `dict[Any, Any]` | A nested structure of lists, tuples, or dictionaries. |
| label | `Optional[str]`           | An optional text label for the tree.             |

#### Outputs
| Name | Type  | Description        |
|:-----|:------|:-------------------|
| Html | `Html` | An HTML object representing the tree. |

#### Internal Logic
1. **Type Checking**: The function first checks if the `items` argument is of type list, tuple, or dict. If not, it raises a `ValueError`.
2. **Formatting**: It attempts to format the structure using `format_structure`. If a `CyclicStructureError` is encountered, it converts the structure to a string.
3. **HTML Conversion**: The formatted data is then passed to `json_output` to generate an HTML representation, which is returned as an `Html` object.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `format_structure` | Formats the input data structure to handle cyclic references. |
| `json_output` | Converts the formatted data into an HTML representation. |
| `CyclicStructureError` | Handles cyclic references in the input data. |

## Error Handling

The function raises a `ValueError` if the `items` argument is not a list, tuple, or dict. It also handles `CyclicStructureError` by converting the structure to a string if cyclic references are detected.

## Logging

There is no explicit logging implemented in this function.

## TODOs

There are no TODOs or notes left in the code.