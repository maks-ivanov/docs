---
title: "microphone.py"
---

## High-level description

The `microphone` class in the `marimo/_plugins/ui/_impl/microphone.py` file is a UI element designed to facilitate audio recording through a user's browser. It extends the `UIElement` class, allowing users to record audio and access the recorded data as an `io.BytesIO` object. The class provides an interface for initializing the microphone element with optional labels and change callbacks, and it includes a method to convert the recorded audio from a base64-encoded string to a binary stream.

## Code Structure

The `microphone` class inherits from the `UIElement` class, which is a generic class designed to represent HTML elements with values that can be synchronized between the frontend and backend. The `microphone` class specifically deals with audio data, converting it from a base64 string to an `io.BytesIO` object. The `UIElement` class provides the foundational structure for managing UI elements, including initialization, value conversion, and change handling.

## References

- `UIElement`: The `microphone` class extends this class to inherit functionality for managing UI elements.
- `mddoc`: A decorator used to add rich documentation to the `microphone` class.

## Symbols

### `microphone`
#### Description
The `microphone` class is a UI element that allows users to record audio through their browser. It provides an interface for capturing audio input, converting it to a binary format, and handling changes in the recorded data.

#### Inputs
| Name     | Type                               | Description                                      |
|:---------|:-----------------------------------|:-------------------------------------------------|
| `label`  | `str`                              | An optional text label for the microphone element. |
| `on_change` | `Optional[Callable[[io.BytesIO], None]]` | An optional callback function that is triggered when the recorded audio changes. |

#### Outputs
| Name   | Type       | Description                                      |
|:-------|:-----------|:-------------------------------------------------|
| `value` | `io.BytesIO` | The recorded audio data as a binary stream. |

#### Internal Logic
- **Initialization**: The constructor initializes the microphone element with a component name, initial value, label, and optional change callback. It calls the superclass constructor with these parameters.
- **Value Conversion**: The `_convert_value` method decodes a base64-encoded string into an `io.BytesIO` object, which represents the recorded audio data.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `base64`   | Used for decoding base64-encoded audio data. |
| `io`       | Provides the `BytesIO` class for handling binary data streams. |
| `typing`   | Provides type annotations for better code clarity and type checking. |

## Error Handling

The `microphone` class does not explicitly handle errors beyond what is provided by the `UIElement` class. The `_convert_value` method assumes that the input string is a valid base64-encoded string and does not include error handling for decoding failures.

## Logging

The `microphone` class does not implement any logging mechanisms. Any logging would likely be handled by the broader application or framework in which this class is used.

## TODOs

There are no TODOs or notes left in the code.