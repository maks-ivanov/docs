---
title: "UploadFile.tsx"
---

## High-level description
The `UploadFile` component provides a user interface for uploading files to the Trieve platform. It allows users to select multiple files or folders, specify optional metadata, and initiate the upload process. The component also handles file validation, displays upload progress, and provides feedback on the upload status.

## Table of contents
- Imports
- Interface `RequestBody`
- Component `UploadFile`
  - State variables
  - Event handlers
    - `handleDrop`
    - `traverseFileTree`
    - `handleDirectUpload`
    - `uploadFiles`
  - JSX Structure

## References
- `DatasetAndUserContext` from "./Contexts/DatasetAndUserContext"
- `JsonInput` from "shared/ui"

## Symbols

### Symbol Name: `UploadFile`
#### Description
This component provides the UI and logic for uploading files. It allows users to select files or folders, add optional metadata, and upload them to the server.

#### Inputs
This component does not take any props.

#### Outputs
This component does not return any value directly. It renders the upload UI.

#### Internal Logic
1. **Initialization:** Sets up state variables for managing files, upload progress, errors, and other options.
2. **File Selection:** Handles both drag-and-drop and direct file selection using input elements.
3. **Folder Traversal:** If a folder is selected, it recursively traverses the folder structure to extract all files.
4. **Upload Handling:** When the "Upload and Chunk Files" button is clicked:
   - Validates if any files are selected.
   - Converts selected files to base64 format.
   - Constructs the request body with file data, metadata, and other options.
   - Sends an HTTP POST request to the `/file` endpoint for each file.
   - Updates the UI based on the upload status (success, error).

## Side Effects
- Modifies the DOM by rendering the file upload UI.
- Makes API requests to upload files.
- Updates state variables based on user interactions and API responses.

#### Performance Considerations
- File conversion to base64 is done asynchronously using Promises to avoid blocking the UI thread.
- The component could benefit from chunking large files before upload to improve performance and handle potential network interruptions.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| solid-js | Core library for building the UI |
| solid-icons | Provides icons used in the UI |
| shared/ui | Contains reusable UI components like `JsonInput` |

### Configuration
The component uses environment variables for configuration:
| Option | Type | Description |
|:-------|:-----|:------------|
| `VITE_API_HOST` | string | The base URL of the API server |
| `VITE_DASHBOARD_URL` | string | The URL of the dashboard page |

## Error Handling
- The component displays error messages to the user if:
  - No files are selected for upload.
  - The API request fails.
- Specific error messages are provided based on the reason for failure.

## Logging
The component logs errors to the console for debugging purposes.
