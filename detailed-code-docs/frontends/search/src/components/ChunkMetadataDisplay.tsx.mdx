---
title: "ChunkMetadataDisplay.tsx"
---

## High-level description
The `ChunkMetadataDisplay` component is responsible for rendering the metadata and content of a single chunk. It provides functionality to expand/collapse the chunk content, view full metadata, delete the chunk, edit the chunk, and manage groups associated with the chunk.

## Table of contents
- Chunk Metadata Display
- Get Local Time
- Chunk Metadata Display Props
- Chunk Metadata Display Component

## References
- `FullScreenModal` from `./Atoms/FullScreenModal.tsx`
- `DatasetAndUserContext` from `./Contexts/DatasetAndUserContext.tsx`
- `createToast` from `./ShowToasts.tsx`
- `Tooltip` from `shared/ui`
- `BookmarkPopover` from `./BookmarkPopover.tsx`
- `formatDate`, `sanitzerOptions` from `./ScoreChunk.tsx`

## Symbols

### `getLocalTime`
#### Description
Converts a UTC date string or Date object to the user's local time.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| strDate | string \| Date | The UTC date string or Date object to convert. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| localTime | Date | The date converted to the user's local time. |

#### Internal Logic
1. Creates a new Date object from the input `strDate`.
2. Gets the user's time zone offset in minutes.
3. Creates a new Date object representing the local time by subtracting the time zone offset from the UTC date.

### `ChunkMetadataDisplay`
#### Description
Renders the metadata and content of a single chunk.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| totalGroupPages | number | The total number of pages of chunk groups. |
| signedInUserId | string \| undefined | The ID of the signed-in user. |
| viewingUserId | string \| undefined | The ID of the user whose chunks are being viewed. |
| chunk | ChunkMetadata | The chunk metadata to display. |
| score | number \| undefined | The score of the chunk. |
| chunkGroups | ChunkGroupDTO[] | An array of chunk groups. |
| bookmarks | ChunkBookmarksDTO[] | An array of chunk bookmarks. |
| setShowConfirmModal | Setter\&lt;boolean\&gt; | A setter function to control the visibility of a confirmation modal. |
| fetchChunkGroups | () =&gt; void | A function to fetch chunk groups. |
| setChunkGroups | Setter\&lt;ChunkGroupDTO[]\&gt; | A setter function to update the chunk groups. |
| setOnDelete | Setter\&lt;() =&gt; void\&gt; | A setter function to set the function to be called when the delete button is clicked. |
| showExpand | boolean \| undefined | Whether to show the expand/collapse button. |

#### Outputs
JSX element representing the rendered chunk metadata and content.

#### Internal Logic
1. Renders the chunk metadata, including ID, tracking ID, tag set, time stamp, location, and metadata.
2. Renders the chunk content, allowing for expansion and collapsing if the content is long.
3. Provides buttons for deleting, editing, and viewing the chunk.
4. Includes a `BookmarkPopover` component for managing groups associated with the chunk.
5. Uses a `FullScreenModal` to display the full metadata in a modal when requested.

## Side Effects
- Modifies the global state by calling `props.setOnDelete` to set the delete function.
- Modifies the global state by calling `props.setShowConfirmModal` to control the confirmation modal visibility.
- Makes API requests to delete the chunk and fetch chunk groups.

## Dependencies
- `solid-js`
- `solid-icons/bi`
- `sanitize-html`
- `solid-icons/fi`
- `shared/ui`

## Error Handling
- Basic error handling is implemented for the API request to delete the chunk. If the request fails, an alert is displayed.

## Logging
- No specific logging mechanisms are implemented in this component.
