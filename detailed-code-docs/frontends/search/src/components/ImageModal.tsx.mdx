---
title: "ImageModal.tsx"
---

## High-level description
The `ImageModal` component displays a full-screen modal containing a series of images fetched from a specified range. It retrieves signed URLs for each image in the range and renders them within the modal.

## Table of contents
- ImageModal component

## References
- `FullScreenModal` component from `./Atoms/FullScreenModal`
- `DatasetAndUserContext` context from `./Contexts/DatasetAndUserContext`

## Symbols

### `ImageModal`
#### Description
This component displays a full-screen modal containing a series of images. It fetches signed URLs for each image in a specified range and renders them within the modal.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| showImageModal | Accessor&lt;boolean&gt; | An accessor indicating whether the modal is open or closed. |
| setShowImageModal | Setter&lt;boolean&gt; | A setter function to update the `showImageModal` state. |
| imgInformation | Accessor&lt;{ imgRangeStart: number; imgRangeEnd: number; imgRangePrefix: string } \| null&gt; | An accessor providing information about the images to be displayed, including the start and end indices of the range and a prefix for the image file names. |

#### Outputs
This component doesn't return any value directly (void function).

#### Internal Logic
1. **Retrieves API host and context:**
   - Gets the API host from the environment variable `VITE_API_HOST`.
   - Accesses the `DatasetAndUserContext` to retrieve the current dataset ID.
2. **Creates a signal for signed image URLs:**
   - Initializes a signal `signedImageUrlsHashmap` as an empty record to store fetched signed URLs for each image.
3. **Fetches signed URLs for images in the range:**
   - Uses a `createEffect` to trigger fetching signed URLs whenever `imgInformation` changes.
   - Iterates through the specified image range.
   - For each image:
     - Constructs the image file name using the provided prefix and index.
     - Fetches a signed URL for the image from the API endpoint `/file/get_signed_url/{fileName}.png`.
     - Updates the `signedImageUrlsHashmap` signal with the fetched signed URL for the corresponding file name.
4. **Renders the modal:**
   - Uses a `Show` component to conditionally render the modal based on the `showImageModal` state.
   - Renders the `FullScreenModal` component, passing the `isOpen` and `setIsOpen` props to control its visibility.
   - Within the modal:
     - Iterates through the image range again.
     - For each image:
       - Retrieves the corresponding signed URL from the `signedImageUrlsHashmap`.
       - Renders an `&lt;img&gt;` tag with the signed URL as the source.

## Side Effects
- Fetches data from the API to retrieve signed image URLs.
- Updates the `signedImageUrlsHashmap` signal with fetched URLs.
- Updates the `showImageModal` state via the `setShowImageModal` prop.

## Dependencies
- solid-js
- @solidjs/router

## Future Improvements
- Implement image preloading for smoother user experience.
- Add error handling for failed image URL fetches.
- Consider adding navigation buttons within the modal to cycle through images.
