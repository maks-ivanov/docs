---
title: "SimpleTimeRangeSelector.tsx"
---

## High-level description
The code defines a reusable React component, `SimpleTimeRangeSelector`, for selecting a time range from a predefined list of options. It also includes a custom hook, `useSimpleTimeRange`, for managing the selected time range and deriving relevant filter and granularity values for analytics queries.

## Table of contents
- `getReasonableGranularityFromDateRange` function
- `useSimpleTimeRange` hook
- `SimpleTimeRangeSelector` component

## Code Structure
The `SimpleTimeRangeSelector` component uses the `useSimpleTimeRange` hook to manage the selected time range. The hook itself relies on the `getReasonableGranularityFromDateRange` function to determine an appropriate granularity based on the selected time range.

## References
- `DateRangeOption` type from `./FilterBar`
- `dateRanges` array from `./FilterBar`
- `AnalyticsParams` type from `shared/types`
- `Select` component from `shared/ui`

## Symbols

### `getReasonableGranularityFromDateRange`
#### Description
This function determines a reasonable granularity for analytics queries based on the selected date range. For example, if the user selects "Past Hour", the granularity should be "minute".

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dateRange | `DateRangeOption` | The selected date range option. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| granularity | `AnalyticsParams["granularity"]` | The determined granularity ("minute", "hour", or "day"). |

#### Internal Logic
The function uses a switch statement to map each date range label to a corresponding granularity.

### `useSimpleTimeRange`
#### Description
This hook manages the state and logic for the simple time range selection. It stores the selected date option, derives the corresponding filter object and granularity, and provides functions to update the selected date option.

#### Inputs
_This symbol has no inputs._

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| filter | `AnalyticsParams["filter"]` | A filter object for analytics queries based on the selected date range. |
| granularity | `AnalyticsParams["granularity"]` | The determined granularity based on the selected date range. |
| dateOption | `DateRangeOption` | The currently selected date range option. |
| setDateOption | `(date: DateRangeOption) =&gt; void` | A function to update the selected date range option. |

#### Internal Logic
- Uses `createSignal` to store and update the selected `dateOption`.
- Uses `createMemo` to derive the `granularity` and `filter` based on the `dateOption`.
- The `filter` object is constructed with a `date_range` property that filters data greater than the selected date.

### `SimpleTimeRangeSelector`
#### Description
This component renders a dropdown menu (`Select` component) to allow users to select a time range from a predefined list of options.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| label | `JSX.Element` | An optional label for the dropdown menu. |
| dateOption | `DateRangeOption` | The currently selected date range option. |
| setDateOption | `(date: DateRangeOption) =&gt; void` | A function to update the selected date range option. |

#### Outputs
_This symbol has no defined outputs._

#### Internal Logic
- Renders a `Select` component from `shared/ui`.
- Passes the `label`, `dateOption`, `setDateOption`, and `dateRanges` props to the `Select` component.
- The `Select` component handles rendering the dropdown menu and updating the selected `dateOption` via the provided `setDateOption` function.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| solid-js | Core library for building the component and hook. |
| date-fns | Used for date manipulation (subtracting hours and days). |
| shared/types | Provides type definitions for `AnalyticsParams` and `DateRangeOption`. |
| shared/ui | Provides the reusable `Select` component. |

## Future Improvements
- The `getReasonableGranularityFromDateRange` function could be extended to support a wider range of date ranges and granularities.
- The component could be modified to accept a custom list of date ranges instead of relying solely on the `dateRanges` array from `./FilterBar`.
- The component could be enhanced to support selecting both a start and end date for the time range.
