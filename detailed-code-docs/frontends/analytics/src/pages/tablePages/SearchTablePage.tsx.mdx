---
title: "SearchTablePage.tsx"
---

## High-level description
This code defines a React component called `SearchTablePage` that displays a table of search query data. It allows users to filter, sort, and paginate through the data. The component fetches data from an API and uses various UI components for filtering, sorting, and pagination.

## Table of contents
- Imports
- `SearchTablePage` component
  - State variables
  - Data fetching
  - `SortableHeader` component
  - JSX structure
- `SearchRow` component
- `formatSearchMethod` function

## Code Structure
The code defines two main components: `SearchTablePage` and `SearchRow`. 

- `SearchTablePage` is the main component that handles data fetching, filtering, sorting, and pagination. 
- It uses the `FilterBar` component for filtering, the `SortableHeader` component for sorting, and the `PaginationButtons` component for pagination. 
- The `SearchTablePage` component renders a `Table` component, which in turn renders `SearchRow` components for each row of data.

## References
- `getSearchQueries` (from `../../api/tables`)
- `DatasetContext` (from `../../layouts/TopBarLayout`)
- `usePagination` (from `../../hooks/usePagination`)
- `parseCustomDateString` (from `../../utils/formatDate`)

## Symbols

### `Symbol Name`
#### `SearchTablePage`
#### Description
This component fetches search query data from an API and displays it in a table. It provides filtering, sorting, and pagination functionality.

#### Inputs
This component does not take any props.

#### Outputs
This component renders a JSX structure representing the search table page.

#### Internal Logic
1. **State Management:**
   - Uses `createStore` to manage filter settings (`filters`) for the search queries.
   - Uses `createSignal` to manage sort order (`sortOrder`), sort by column (`sortBy`), and pagination (`pages`).
   - Retrieves the active dataset from the `DatasetContext`.

2. **Data Fetching:**
   - Employs `createQuery` from `@tanstack/solid-query` to fetch search query data based on filters, pagination, sorting, and the selected dataset.
   - Prefetches the next page of data using `queryClient.prefetchQuery` for smoother pagination.

3. **UI Rendering:**
   - Renders a `FilterBar` component, passing the current filters and a function to update them.
   - Conditionally renders the search table if data is loaded, otherwise displays a loading message.
   - The table includes sortable headers for "Searched At", "Latency", and "Top Score".
   - Each row in the table is rendered using the `SearchRow` component.
   - Displays pagination buttons using the `PaginationButtons` component.

### `Symbol Name`
#### `SearchRow`
#### Description
This component renders a single row in the search table.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| event | `SearchQueryEvent` | The search query event data for this row. |
| filter | `AnalyticsParams["filter"]` | The current filter settings. |

#### Outputs
This component renders a JSX structure representing a single row in the search table.

#### Internal Logic
- Uses `createMemo` to format the search method based on the `event.request_params`.
- Conditionally renders the "Search Method" column based on the `filter.search_method` value.

### `Symbol Name`
#### `formatSearchMethod`
#### Description
This function takes a search method string and returns a formatted version for display.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| searchMethod | `string` | The search method string to format. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| formattedSearchMethod | `string` | The formatted search method string. |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| solid-js | Core library for building the user interface. |
| @tanstack/solid-query | Used for data fetching and caching. |
| date-fns | Used for date and time formatting. |
| shared/types | Provides shared type definitions. |
| shared/ui | Provides shared UI components. |
| ../../api/tables | Provides API functions for fetching table data. |
| ../../layouts/TopBarLayout | Provides the layout context for the page. |
| ../../hooks/usePagination | Provides a custom hook for pagination. |
| ../../utils/formatDate | Provides utility functions for date formatting. |
| solid-icons/ai | Provides icons from the Ant Design library. |

## Error Handling
The `searchTableQuery` uses a try-catch block to handle errors during data fetching. If an error occurs, it will be thrown and can be handled by an error boundary higher up in the component tree.

## Logging
This code does not implement any specific logging mechanisms.
