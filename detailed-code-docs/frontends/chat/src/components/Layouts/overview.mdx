---
title: "Overview"
---

```diff
--- a/frontends/chat/src/components/Layouts/MainLayout.tsx
+++ b/frontends/chat/src/components/Layouts/MainLayout.tsx
@@ -14,6 +14,7 @@
   isMessageArray,
   messageRoleFromIndex,
   type Message,
+  MessageContentType,
 } from "../../types/messages";
 import { AfMessage } from "../Atoms/AfMessage";
 import { UserContext } from "../contexts/UserContext";
@@ -87,7 +88,7 @@
           }
 
           const newMessage = {
-            content: lastMessage.content + newText,
+            content: [lastMessage.content[0], lastMessage.content[1] + newText],
           };
           return [...prev.slice(0, prev.length - 1), newMessage];
         });
@@ -152,7 +153,7 @@
     let requestMethod = "POST";
     if (regenerateLastMessage) {
       requestMethod = "PATCH";
-      setMessages((prev): Message[] =&gt; {
+      setMessages((prev) =&gt; {
         const newMessages = [{ content: "" }];
         return [...prev.slice(0, -1), ...newMessages];
       });
@@ -165,13 +166,13 @@
 
       setMessages((prev) =&gt; {
         if (prev.length === 0) {
-          return [
-            { content: "" },
-            { content: new_message_content },
-            { content: "" },
+          return [ { content: ["system", ""] },
+            { content: ["user", new_message_content] },
+            { content: ["assistant", ""] },
           ];
         }
-        const newMessages = [{ content: new_message_content }, { content: "" }];
+        const newMessages = [{ content: ["user", new_message_content] }, {
+          content: ["assistant", ""],
+        }];
         return [...prev, ...newMessages];
       });
     }
@@ -269,8 +270,9 @@
               return (
                 &lt;AfMessage
                   normalChat={false}
-                  role={messageRoleFromIndex(idx())}
-                  content={message.content}
+                  role={message.content[0] as MessageContentType}
+                  messageContent={message.content[1]}
                   streamingCompletion={streamingCompletion}
                   onEdit={(content: string) =&gt; {
                     const dataset = userContext.currentDataset?.();
@@ -278,7 +280,7 @@
                     if (!dataset) return;
 
                     const newMessage: Message = {
-                      content: "",
+                      content: [message.content[0], ""],
                     };
                     setMessages((prev) =&gt; {
                       return [...prev.slice(0, idx() + 1), newMessage];

```