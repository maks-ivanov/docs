---
title: "ingress-aws.yaml"
---

## High-level description
This Helm template defines Kubernetes Ingress resources and Network Policies for an AWS environment. It sets up ALB (Application Load Balancer) Ingress controllers for various services including dashboard, chat, server, and search, along with network policies allowing all ingress and egress traffic.

## Table of contents
- Ingress for dashboard service
- Ingress for chat service
- Ingress for server service
- Ingress for search service
- Network Policy for allowing all ingress traffic
- Network Policy for allowing all egress traffic

## Code Structure
The file contains multiple Kubernetes resource definitions, each separated by `---`. The resources are conditionally created based on the environment being "aws". All Ingress resources use the ALB ingress class and are configured for internet-facing load balancers.

## Symbols

### Ingress Resources
#### Description
Four Ingress resources are defined for different services: dashboard, chat, server, and search. Each Ingress resource sets up routing rules for a specific subdomain.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| .Values.domain | string | The domain name used for constructing subdomains |
| .Values.environment | string | The deployment environment, must be "aws" for these resources to be created |

#### Internal Logic
1. Check if the environment is "aws"
2. Define Ingress resources with ALB annotations
3. Set up routing rules for each service's subdomain
4. Configure health checks for the server service

### Network Policies
#### Description
Two NetworkPolicy resources are defined to allow all ingress and egress traffic for all pods in the namespace.

#### Internal Logic
1. Define a NetworkPolicy that allows all ingress traffic
2. Define a NetworkPolicy that allows all egress traffic

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| Kubernetes networking.k8s.io/v1 API | Used for Ingress and NetworkPolicy definitions |
| ALB Ingress Controller | Required for processing the ALB-specific annotations |
| ExternalDNS | Used for automatic DNS record creation (implied by annotations) |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| .Values.environment | string | N/A | Must be set to "aws" for these resources to be created |
| .Values.domain | string | N/A | The base domain for constructing service subdomains |

## Future Improvements
- Consider adding TLS configuration for secure HTTPS connections
- Implement more granular NetworkPolicies for improved security
- Add support for other cloud providers or on-premises environments
- Consider using variables for repeated values like ingress class and ALB scheme