---
title: "prometheusrule.yaml"
---

## High-level description
This YAML template defines a PrometheusRule resource for Redis in a Kubernetes environment. It configures monitoring rules for Prometheus when metrics and PrometheusRule are enabled in the Helm chart values.

## Table of contents
- Conditional resource creation
- Resource metadata
- Resource specification

## Code Structure
The template is structured as a single Kubernetes resource definition, with various sections populated using Helm templating functions and values from the chart's configuration.

## Symbols

### PrometheusRule Resource
#### Description
Defines a PrometheusRule resource for Prometheus monitoring of Redis.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| .Values.metrics.enabled | boolean | Enables metrics collection |
| .Values.metrics.prometheusRule.enabled | boolean | Enables PrometheusRule creation |
| .Values.metrics.prometheusRule.namespace | string | Namespace for the PrometheusRule |
| .Values.commonLabels | object | Common labels to apply |
| .Values.metrics.prometheusRule.additionalLabels | object | Additional labels for the PrometheusRule |
| .Values.commonAnnotations | object | Common annotations to apply |
| .Values.metrics.prometheusRule.rules | array | Prometheus monitoring rules |

#### Internal Logic
1. Checks if metrics and PrometheusRule are enabled
2. Defines the resource using the `monitoring.coreos.com/v1` API version
3. Sets metadata including name, namespace, labels, and annotations
4. Specifies the rules in the `spec` section

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| common.names.fullname | Generates the full name for the resource |
| common.names.namespace | Provides the namespace |
| common.labels.standard | Generates standard labels |
| common.tplvalues.render | Renders template values |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| metrics.enabled | boolean | - | Enables metrics collection |
| metrics.prometheusRule.enabled | boolean | - | Enables PrometheusRule creation |
| metrics.prometheusRule.namespace | string | - | Namespace for the PrometheusRule |
| metrics.prometheusRule.additionalLabels | object | - | Additional labels for the PrometheusRule |
| metrics.prometheusRule.rules | array | - | Prometheus monitoring rules |

## Future Improvements
- Consider adding validation for required fields in the `.Values` object
- Implement default rules if none are provided in `.Values.metrics.prometheusRule.rules`
- Add support for multiple rule groups instead of a single group