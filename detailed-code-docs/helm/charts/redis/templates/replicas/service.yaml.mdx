---
title: "service.yaml"
---

## High-level description
This YAML template defines a Kubernetes Service for Redis replicas in a replication architecture. It configures various service properties and exposes the Redis port, with support for different service types and additional customization options.

## Table of contents
- Service metadata
- Service specification
- Port configuration
- Selector configuration

## Code Structure
The template uses conditional statements and helper functions to dynamically generate the Service configuration based on the provided values. It heavily relies on the `.Values` object to customize various aspects of the Service.

## Symbols

### Service Definition
#### Description
Defines a Kubernetes Service for Redis replicas when the architecture is set to "replication" and sentinel is not enabled.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| .Values | Object | Contains all the configuration values for the chart |

#### Internal Logic
1. Checks if the architecture is "replication" and sentinel is not enabled
2. Sets metadata (name, namespace, labels, and annotations)
3. Configures service spec based on the provided values
4. Defines ports and selectors

## Side Effects
This template creates a Kubernetes Service resource when the specified conditions are met.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| common | Provides helper functions for naming, labels, and template rendering |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| .Values.architecture | String | - | Must be set to "replication" for this service to be created |
| .Values.sentinel.enabled | Boolean | - | Must be false for this service to be created |
| .Values.replica.service.* | Object | - | Various service configuration options |

## Future Improvements
- Consider adding support for IPv6 configurations
- Implement more flexible port configuration options
- Add support for custom labels and annotations at the port level