---
title: "serviceaccount.yaml"
---

## High-level description
This YAML template defines a Kubernetes ServiceAccount for Redis replicas in a replication architecture. It's conditionally created based on specific configuration values and includes metadata such as labels and annotations.

## Table of contents
- ServiceAccount definition
- Metadata configuration
- Labels and annotations

## Code Structure
The file consists of a single Kubernetes resource definition (ServiceAccount) with conditional creation and metadata configuration.

## Symbols

### ServiceAccount
#### Description
Defines a Kubernetes ServiceAccount for Redis replicas, created only under specific conditions.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| .Values.replica.serviceAccount.create | boolean | Determines if the ServiceAccount should be created |
| .Values.architecture | string | The Redis architecture type |
| .Values.sentinel.enabled | boolean | Indicates if Redis Sentinel is enabled |

#### Internal Logic
1. Checks if the ServiceAccount should be created based on input values
2. Sets the API version and kind for the ServiceAccount
3. Configures the automountServiceAccountToken setting
4. Sets the metadata including name, namespace, labels, and annotations

## Side Effects
Creates a Kubernetes ServiceAccount when conditions are met, which may affect pod permissions and security context.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| common | Provides helper templates for labels, annotations, and namespace |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| .Values.replica.serviceAccount.create | boolean | - | Whether to create the ServiceAccount |
| .Values.architecture | string | - | Redis architecture type |
| .Values.sentinel.enabled | boolean | - | Whether Redis Sentinel is enabled |
| .Values.replica.serviceAccount.automountServiceAccountToken | boolean | - | Whether to automount the ServiceAccount token |

## Future Improvements
- Consider adding support for custom ServiceAccount names
- Implement conditional creation of additional RBAC resources (e.g., Roles, RoleBindings) if needed for the Redis replicas