---
title: "serviceaccount.yaml"
---

## High-level description
This YAML template defines a Kubernetes ServiceAccount for Redis when Sentinel mode is enabled. It includes conditional creation, metadata, labels, and annotations based on the provided values.

## Table of contents
- ServiceAccount definition
- Metadata
- Labels
- Annotations

## Code Structure
The file contains a single Kubernetes resource definition (ServiceAccount) with nested conditional blocks for various attributes.

## Symbols

### ServiceAccount
#### Description
Defines a Kubernetes ServiceAccount for Redis when both `serviceAccount.create` and `sentinel.enabled` are true.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| .Values.serviceAccount.create | boolean | Controls whether to create the ServiceAccount |
| .Values.sentinel.enabled | boolean | Indicates if Redis Sentinel mode is enabled |
| .Values.serviceAccount.automountServiceAccountToken | boolean | Controls automatic mounting of the service account token |

#### Internal Logic
1. Checks if both `serviceAccount.create` and `sentinel.enabled` are true
2. Sets the API version and kind for the ServiceAccount
3. Configures automountServiceAccountToken
4. Sets metadata including name, namespace, labels, and annotations

### Metadata
#### Description
Defines the metadata for the ServiceAccount, including name, namespace, labels, and annotations.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| .Values.commonLabels | map | Common labels to apply |
| .Values.commonAnnotations | map | Common annotations to apply |
| .Values.serviceAccount.annotations | map | ServiceAccount-specific annotations |

#### Internal Logic
1. Sets the name using the `redis.serviceAccountName` template
2. Sets the namespace using the `common.names.namespace` template
3. Applies labels using the `common.labels.standard` template
4. Conditionally applies annotations by merging common and ServiceAccount-specific annotations

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| common.labels.standard | Generates standard labels |
| common.names.namespace | Provides the namespace name |
| common.tplvalues.merge | Merges multiple values |
| common.tplvalues.render | Renders template values |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| serviceAccount.create | boolean | - | Controls ServiceAccount creation |
| sentinel.enabled | boolean | - | Enables Redis Sentinel mode |
| serviceAccount.automountServiceAccountToken | boolean | - | Controls token auto-mounting |

## Future Improvements
- Consider adding support for custom labels specific to the ServiceAccount
- Implement conditional creation of additional resources related to the ServiceAccount, such as RBAC roles
- Add support for specifying resource limits or quotas for the ServiceAccount