---
title: "secret-svcbind.yaml"
---

## High-level description
This Helm template generates a Kubernetes Secret resource for Redis service binding. It provides connection details for Redis, including host, port, password, and URI, encoded in base64 format.

## Table of contents
- Secret metadata
- Secret type
- Secret data

## Code Structure
The template uses conditional logic to determine the correct host and port based on whether Redis Sentinel is enabled. It then creates a Secret resource with the necessary connection information.

## Symbols

### Redis Secret Template
#### Description
This Helm template creates a Kubernetes Secret resource for Redis service binding. It includes connection details such as host, port, password, and URI.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| .Values.serviceBindings.enabled | boolean | Determines if the service binding secret should be created |
| .Values.sentinel.enabled | boolean | Indicates if Redis Sentinel is enabled |
| .Values.master.service.ports.redis | string/number | Redis master service port |
| .Values.sentinel.service.ports.redis | string/number | Redis Sentinel service port |

#### Outputs
A Kubernetes Secret resource with Redis connection details.

#### Internal Logic
1. Check if service bindings are enabled
2. Determine the correct host based on Sentinel configuration
3. Set the appropriate port based on Sentinel configuration
4. Retrieve the Redis password
5. Create the Secret resource with metadata and labels
6. Populate the Secret data with base64 encoded connection details

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| common.names.fullname | Generate the full name for resources |
| common.names.namespace | Get the namespace |
| common.labels.standard | Generate standard labels |
| common.tplvalues.render | Render template values |
| redis.password | Retrieve the Redis password |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| .Values.serviceBindings.enabled | boolean | - | Enable/disable service binding secret creation |
| .Values.sentinel.enabled | boolean | - | Enable/disable Redis Sentinel |
| .Values.commonLabels | object | - | Common labels to be added to the secret |
| .Values.commonAnnotations | object | - | Common annotations to be added to the secret |

## Future Improvements
- Consider adding support for TLS connections in the URI
- Implement versioning for the Secret to allow for easier updates and rollbacks
- Add optional fields for additional Redis configuration parameters (e.g., database number, connection timeout)