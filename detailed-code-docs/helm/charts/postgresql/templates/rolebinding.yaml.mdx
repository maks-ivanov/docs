---
title: "rolebinding.yaml"
---

## High-level description
This YAML template defines a Kubernetes RoleBinding resource for PostgreSQL, linking a Role to a ServiceAccount. It's part of a Helm chart and is conditionally created based on RBAC settings.

## Table of contents
- RoleBinding definition
- Metadata
- RoleRef
- Subjects

## Code Structure
The template uses Helm functions and conditionals to dynamically generate a Kubernetes RoleBinding resource. It references common templates for naming, labels, and capabilities.

## Symbols

### RoleBinding
#### Description
Defines a Kubernetes RoleBinding resource that associates a Role with a ServiceAccount.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| .Values.rbac.create | boolean | Determines if the RoleBinding should be created |
| .Values.commonLabels | map | Custom labels to be applied |
| .Values.commonAnnotations | map | Custom annotations to be applied |
| .Release.Namespace | string | Namespace where the resource is deployed |

#### Internal Logic
1. Checks if RBAC creation is enabled
2. Sets the apiVersion using a common capability template
3. Generates metadata including name, namespace, labels, and annotations
4. Defines the roleRef pointing to the associated Role
5. Specifies the subject (ServiceAccount) to bind to the Role

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| common.capabilities.rbac.apiVersion | Determines the appropriate RBAC API version |
| common.names.fullname | Generates the full name for the resource |
| common.labels.standard | Applies standard labels |
| common.tplvalues.render | Renders template values |
| postgresql.v1.serviceAccountName | Retrieves the PostgreSQL ServiceAccount name |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| rbac.create | boolean | - | Controls whether to create the RoleBinding |
| commonLabels | map | - | Custom labels to apply to the resource |
| commonAnnotations | map | - | Custom annotations to apply to the resource |

## Future Improvements
- Consider adding support for multiple subjects if needed for more complex RBAC scenarios
- Implement conditional creation of the RoleBinding based on the existence of the referenced Role
- Add validation to ensure the referenced Role and ServiceAccount exist before creating the RoleBinding