---
title: "psp.yaml"
---

## High-level description
This YAML file defines a PodSecurityPolicy (PSP) for a PostgreSQL Helm chart. It sets up security constraints for pods running in a Kubernetes cluster, specifically tailored for a PostgreSQL deployment.

## Table of contents
- PodSecurityPolicy definition
- Metadata section
- Spec section

## Code Structure
The file contains a single Kubernetes resource definition (PodSecurityPolicy) with metadata and spec sections. The content is conditionally rendered based on Helm template logic.

## Symbols

### PodSecurityPolicy
#### Description
Defines a PodSecurityPolicy resource that specifies security constraints for pods in the PostgreSQL deployment.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| .Values.psp.create | Boolean | Determines whether to create the PSP |
| .Values.commonLabels | Map | Custom labels to be added to the resource |
| .Values.commonAnnotations | Map | Custom annotations to be added to the resource |

#### Internal Logic
1. Checks if PSP is supported and if it should be created
2. Sets up metadata including name, namespace, labels, and annotations
3. Defines spec with security constraints for pods

## Side Effects
Creates a PodSecurityPolicy resource in the Kubernetes cluster when applied.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| common.capabilities.psp.supported | Checks if PSP is supported in the cluster |
| common.names.fullname | Generates the full name for the resource |
| common.labels.standard | Generates standard labels |
| common.tplvalues.render | Renders template values |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| .Values.psp.create | Boolean | N/A | Determines whether to create the PSP |
| .Values.commonLabels | Map | N/A | Custom labels to be added to the resource |
| .Values.commonAnnotations | Map | N/A | Custom annotations to be added to the resource |

## Error Handling
No explicit error handling is implemented in this template.

## Future Improvements
- Consider adding more flexible configuration options for PSP settings
- Implement support for newer versions of the PSP API (policy/v1beta1 is deprecated)
- Add comments explaining the purpose of each PSP constraint for better maintainability