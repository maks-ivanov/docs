---
title: "Overview"
---

## High-level description

The `cassiopeia/data` directory is a crucial component of the Cassiopeia library, designed to handle phylogenetic trees and related data structures for lineage tracing analysis. The primary class within this directory is the `CassiopeiaTree`, which represents a phylogenetic tree structure and provides methods for manipulating the tree, reconstructing ancestral characters, computing dissimilarities, and managing layers of character matrices. The directory also includes a `Layers` class for managing multiple versions of character matrices, utility functions for various tree and data manipulations, and an `__init__.py` file that exposes key classes and functions at the package level.

## What does it do?

The `cassiopeia/data` directory provides the functionality to represent and manipulate phylogenetic trees, which are used to trace the lineage of cells based on mutation data. The `CassiopeiaTree` class allows users to input a tree topology and a character matrix that represents mutation observations for each cell. Users can then perform various operations such as:

- **Tree Manipulation**: Add or remove nodes, set character states, and manage tree topology.
- **Ancestral Character Reconstruction**: Use parsimony criteria to infer the character states of internal nodes in the tree.
- **Dissimilarity Computation**: Calculate pairwise dissimilarities between samples based on their character states.
- **Layer Management**: Store and manage multiple versions of character matrices, which can be useful for simulations or experiments involving imputation of missing data.

The utility functions in `utilities.py` support these operations by providing tools for converting between different tree representations, computing dissimilarity maps, generating bootstrap samples, and more.

## Entry points

The main entry point for users is the `CassiopeiaTree` class, which is the central data structure for representing and manipulating phylogenetic trees. The `Layers` class is used internally by `CassiopeiaTree` to manage multiple character matrices. The utility functions in `utilities.py` are used to perform specific tasks related to phylogenetic data processing, such as converting tree formats and computing dissimilarity maps.

## Key Files

- **CassiopeiaTree.py**: Contains the `CassiopeiaTree` class, which is the core data structure for representing phylogenetic trees. It provides methods for tree manipulation, ancestral character reconstruction, and dissimilarity computation.

- **Layers.py**: Defines the `Layers` class, which manages multiple versions of character matrices within a `CassiopeiaTree` object. It ensures that the matrices are consistent with the tree's structure.

- **utilities.py**: Provides a set of utility functions for handling and processing phylogenetic data. These functions include tools for converting tree representations, computing dissimilarity maps, and generating bootstrap samples.

- **__init__.py**: Serves as the top-level module for the data-related components of the Cassiopeia library. It imports and exposes key classes and utility functions, making them accessible at the package level.

## Dependencies

The `cassiopeia/data` directory relies on several external libraries:

- **ete3**: Used for tree manipulation and conversion between formats.
- **networkx**: Provides graph data structures and algorithms for tree representation.
- **numpy**: Used for numerical operations and data manipulation.
- **pandas**: Utilized for handling data frames and tabular data.
- **scipy**: Provides scientific computing functions, including distance calculations.
- **numba**: Used for optimizing performance of certain functions.

These dependencies are chosen for their robust support of tree and graph operations, data manipulation, and numerical computations, which are essential for phylogenetic analysis.

## Configuration

The `CassiopeiaTree` class and utility functions include various configurable fields, such as:

- **Character Matrix**: A `pandas.DataFrame` representing mutation observations for each cell.
- **Missing State Indicator**: An integer indicating missing states in the character matrix.
- **Priors**: A dictionary storing the probability of each character mutating to a particular state.
- **Tree Topology**: Can be specified as a Newick string, an `ete3.Tree`, or a `networkx.DiGraph`.
- **Dissimilarity Function**: A callable function used to compute dissimilarities between character states.
- **Threads**: Number of threads to use for parallel computation of dissimilarity maps.

These configurations allow users to customize the behavior of the `CassiopeiaTree` and utility functions to suit their specific analysis needs.