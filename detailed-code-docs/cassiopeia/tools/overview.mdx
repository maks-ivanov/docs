---
title: "Overview"
---

## High-level description
The `cassiopeia/tools` directory contains a collection of utility functions and classes for analyzing and manipulating phylogenetic trees, particularly those generated using the Cassiopeia framework. These tools cover a wide range of functionalities, including parameter estimation, tree metrics calculation, fitness estimation, small parsimony analysis, and various other tree-related operations.

## What does it do?
The tools in this directory provide various capabilities for working with phylogenetic trees:

1. Autocorrelation analysis: Computes statistics like Moran's I and Geary's C to measure spatial autocorrelation in tree-structured data.
2. Branch length estimation: Implements algorithms for estimating branch lengths in phylogenetic trees, including Maximum Likelihood and Bayesian approaches.
3. Evolutionary coupling: Calculates the evolutionary coupling between different categories of a meta variable in a phylogenetic tree.
4. Fitness estimation: Provides methods for estimating the fitness of nodes in phylogenetic trees, including the Lineage Branching Index (LBI) method.
5. Parameter estimation: Offers functions to estimate key parameters such as mutation rates and missing data rates from observed tree data.
6. Small parsimony analysis: Implements algorithms for inferring ancestral states and analyzing parsimony in phylogenetic trees.
7. Topology analysis: Includes functions for analyzing tree topology, such as calculating tree imbalance and expansion probabilities.
8. Tree metrics: Provides methods for calculating various metrics on trees, including parsimony scores and likelihood under different models.

These tools allow researchers and data scientists to perform in-depth analysis of phylogenetic trees, extract meaningful information about evolutionary processes, and make inferences about the underlying biological systems represented by the trees.

## Entry points
The main entry points for this module are the various functions and classes defined in each file. Some key entry points include:

1. `fitch_hartigan` in `small_parsimony.py`: For performing Fitch-Hartigan small parsimony analysis.
2. `estimate_mutation_rate` and `estimate_missing_data_rates` in `parameter_estimators.py`: For estimating key parameters from tree data.
3. `LBIJungle` in `fitness_estimator`: For estimating fitness using the Lineage Branching Index method.
4. `calculate_likelihood_continuous` and `calculate_likelihood_discrete` in `tree_metrics.py`: For calculating tree likelihoods under different models.
5. `compute_evolutionary_coupling` in `coupling.py`: For analyzing evolutionary coupling between categories in a tree.

## Dependencies
The tools in this directory rely on several external libraries:

1. numpy: For numerical computations and array operations.
2. pandas: For data manipulation and analysis.
3. scipy: For various scientific computing tasks.
4. networkx: For graph operations and tree manipulations.
5. cvxpy: Used in branch length estimation for convex optimization.
6. jungle: A wrapper around Neher et al.'s original code for LBI calculations.
7. ete3: For phylogenetic tree manipulation and visualization.
8. Biopython: For various bioinformatics operations.

## Configuration
Most of the functions and classes in this module can be configured through their input parameters. There are no global configuration files, but users can adjust the behavior of various algorithms by passing different parameters when calling the functions. For example, many functions allow specifying whether to use continuous or discrete models, or whether to assume certain properties about the tree structure.

The tools are designed to work with the `CassiopeiaTree` data structure, which is central to the Cassiopeia framework. Users should ensure that their tree data is properly formatted and loaded into a `CassiopeiaTree` object before using these tools.

In summary, the `cassiopeia/tools` directory provides a comprehensive set of utilities for analyzing phylogenetic trees, with a focus on lineage tracing and evolutionary analysis. These tools can be used individually or in combination to extract valuable insights from tree-structured biological data.