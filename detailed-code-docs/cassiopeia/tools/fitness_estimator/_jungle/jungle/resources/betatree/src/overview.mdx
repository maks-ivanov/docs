---
title: "Overview"
---

## High-level description

The directory is part of a larger project focused on simulating beta coalescent trees and calculating their Site Frequency Spectrum (SFS), which are important concepts in population genetics. The main components within this directory are classes and functions that facilitate the generation of these trees, the calculation of the SFS, and the visualization of the results. The code leverages mathematical libraries for calculations and uses the BioPython library for tree representation and visualization.

## What does it do?

The code in this directory simulates the ancestry of a sample of individuals using beta coalescent trees. These trees model how lineages of individuals merge over time, which is a key concept in understanding genetic diversity and evolution. The process is controlled by a parameter called `alpha`, which determines the type of coalescent process being simulated. 

Once the trees are generated, the code calculates the Site Frequency Spectrum (SFS), which is a summary of the genetic variation within the sample. The SFS provides insights into the evolutionary history and demographic events that have shaped the genetic diversity of the population.

The code also includes functionality to visualize these trees and the SFS, allowing users to see the results of the simulations. Additionally, it provides methods to save and load the SFS data, making it easier to manage and analyze large datasets.

## Entry points

The main files in this directory are:

- `betatree.py`: This file contains the `betatree` class, which is responsible for simulating the beta coalescent trees. It includes methods for initializing the tree, simulating coalescence events, and constructing the final tree structure.

- `sfs.py` and `sfs_py3.py`: These files define the `SFS` class, which inherits from the `betatree` class. The `SFS` class is responsible for generating multiple trees, calculating the SFS, and providing methods to bin, save, and load the SFS data. Both files offer similar functionality, with `sfs_py3.py` likely being an updated version for Python 3 compatibility.

The code is organized such that the `betatree` class provides the foundational tree simulation capabilities, while the `SFS` class extends this functionality to include SFS calculation and data management.

## Key Files

- **`betatree.py`**: Contains the `betatree` class, which simulates beta coalescent trees. It handles the entire process of tree generation, from initializing the tree to simulating coalescence events and constructing the final tree structure.

- **`sfs.py` and `sfs_py3.py`**: Both files define the `SFS` class, which extends the `betatree` class to include SFS calculation. They provide methods for generating multiple trees, calculating the SFS, binning the data, and saving/loading the SFS. These files also include a `logit` function for logistic transformation, which is used in the binning process.

## Dependencies

The directory relies on several external libraries:

- **`numpy`**: Used for numerical operations and random number generation, which are essential for simulating the coalescent process and calculating the SFS.

- **`scipy`**: Provides special mathematical functions, such as gamma calculations, which are used in the simulation of coalescent events.

- **`Bio` (BioPython)**: Used for representing and visualizing phylogenetic trees, allowing for a clear depiction of the simulated coalescent trees.

- **`matplotlib`**: Utilized for plotting and visualizing the SFS data, providing a graphical representation of the results.

These dependencies were chosen for their robust mathematical capabilities and their ability to handle biological data and visualizations effectively.