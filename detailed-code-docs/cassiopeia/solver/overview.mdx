---
title: "Overview"
---

## High-level description

The `cassiopeia/solver` directory is a comprehensive module within the Cassiopeia library, dedicated to implementing various algorithms for phylogenetic tree reconstruction. These algorithms are designed to infer evolutionary relationships among samples based on their genetic data, represented in character matrices. The directory includes a wide range of solvers, each employing different strategies and methodologies, such as distance-based methods, greedy algorithms, spectral techniques, and integer linear programming. The solvers are built upon a common framework, allowing for flexibility and extensibility in phylogenetic analysis.

## What does it do?

The solvers in this directory are responsible for constructing phylogenetic trees, which are diagrams that represent the evolutionary relationships between different species or samples. Each solver uses a unique approach to analyze the genetic data and determine how the samples are related. For example, some solvers use distance metrics to group similar samples together, while others use greedy algorithms to iteratively build the tree by making local decisions. There are also solvers that use advanced mathematical techniques, such as spectral methods or integer linear programming, to optimize the tree construction process. The end goal of these solvers is to produce a tree that accurately reflects the evolutionary history of the samples, based on the available genetic data.

## Entry points

The main entry points in the directory are the solver classes, each representing a different algorithmic approach to phylogenetic tree reconstruction. These classes include:

- `CassiopeiaSolver`: An abstract base class that defines the interface and common functionality for all solvers.
- `DistanceSolver`: A base class for solvers that use distance metrics to construct trees.
- `GreedySolver`: A base class for solvers that use greedy algorithms to build trees.
- `HybridSolver`: Combines two different solvers to optimize tree reconstruction.
- `ILPSolver`: Uses integer linear programming to find the most parsimonious tree.
- `MaxCutSolver` and `MaxCutGreedySolver`: Implement max-cut optimization for tree partitioning.
- `NeighborJoiningSolver`: Implements the Neighbor-Joining algorithm for distance-based tree construction.
- `PercolationSolver`: Uses a percolation-based approach to partition samples.
- `SharedMutationJoiningSolver`: Clusters samples based on shared mutations.
- `SpectralSolver` and `SpectralGreedySolver`: Use spectral methods to optimize partitions.
- `UPGMASolver`: Implements the UPGMA algorithm for hierarchical clustering.
- `VanillaGreedySolver`: A basic greedy solver for tree reconstruction.

These classes are organized to allow for easy extension and customization, enabling users to implement new algorithms or modify existing ones to suit their specific needs.

## Key Files

- **`CassiopeiaSolver.py`**: Defines the abstract base class for all solvers, providing a common interface and shared functionality.
- **`DistanceSolver.py`**: Implements a base class for distance-based solvers, providing methods for handling dissimilarity maps and merging samples.
- **`GreedySolver.py`**: Implements a base class for greedy solvers, defining the structure for top-down tree construction algorithms.
- **`HybridSolver.py`**: Combines a top-down greedy solver with a bottom-up solver for efficient tree reconstruction.
- **`ILPSolver.py`**: Implements an ILP-based algorithm for maximum parsimony tree inference using Gurobi.
- **`MaxCutSolver.py` and `MaxCutGreedySolver.py`**: Implement max-cut optimization for partitioning samples in a graph.
- **`NeighborJoiningSolver.py`**: Implements the Neighbor-Joining algorithm for constructing phylogenetic trees.
- **`PercolationSolver.py`**: Uses a percolation-based approach to partition samples and build trees.
- **`SharedMutationJoiningSolver.py`**: Clusters samples based on shared mutations using an agglomerative approach.
- **`SpectralSolver.py` and `SpectralGreedySolver.py`**: Use spectral methods to optimize partitions in tree construction.
- **`UPGMASolver.py`**: Implements the UPGMA algorithm for hierarchical clustering.
- **`VanillaGreedySolver.py`**: A basic greedy solver for phylogenetic tree reconstruction.

## Dependencies

The directory relies on several external libraries and frameworks to perform its functions:

- **`networkx`**: Used for graph operations and tree manipulations.
- **`numpy`**: Utilized for numerical operations and matrix manipulations.
- **`pandas`**: Used for handling data in DataFrame format.
- **`scipy`**: Provides functions for linear algebra operations and singular value decomposition.
- **`gurobipy`**: Required for solving ILP problems using Gurobi.
- **`numba`**: Provides JIT compilation for performance optimization.
- **`ete3`**: Used for tree manipulation and operations.

These dependencies are chosen for their efficiency and ability to handle complex mathematical and graph-based operations, which are essential for phylogenetic analysis.

## Configuration

The directory uses configuration files and environment variables to manage settings for external tools and libraries. For example, the `configparser` module is used to read configuration settings for external tool paths, such as those required for fast implementations of certain algorithms. Additionally, environment variables may be used to specify paths to external libraries or tools, such as Gurobi, which is used for ILP optimization. These configurations allow for flexibility and customization in the execution of the solvers, enabling users to tailor the environment to their specific needs.