---
title: "mapbox.py"
---

## High-level description

The `mapbox.py` file is a script that uses the `marimo` framework to create an interactive web application. This application demonstrates how to use Plotly's Mapbox functionality to create a scatter plot on a street map, with an option to switch to a satellite view. The script fetches data about US cities and visualizes it on a map, allowing users to toggle between different map styles.

## Code Structure

The code is structured using the `marimo` framework, which organizes the application into cells. Each cell is a function decorated with `@app.cell`, and these cells are executed in sequence to build the application. The main components include importing necessary libraries, defining UI elements, fetching and processing data, and rendering the map visualization.

## Symbols

### `app`
#### Description
`app` is an instance of `marimo.App`, which serves as the main application object. It is used to define and run the web application.

### `@app.cell`
#### Description
The `@app.cell` decorator is used to define a function as a cell in the `marimo` application. Each cell represents a unit of functionality, such as rendering UI components or processing data.

### `__generated_with`
#### Description
This variable indicates the version of the tool or framework used to generate the script, which is "0.1.51" in this case.

### `__()`
#### Description
Multiple functions are defined with the name `__`, each serving a different purpose within the application. These functions are differentiated by their parameters and the logic they contain.

#### Inputs and Outputs
- The first `__` function takes `mo` as input and outputs nothing. It renders a markdown description of the application.
- The second `__` function takes `mo` as input and returns a UI switch component for toggling the satellite view.
- The third `__` function takes `mo`, `get_map`, and `view_button` as inputs and returns a Plotly figure based on the map data.
- The fourth `__` function takes `f` and `mo` as inputs and outputs a table representation of the map data.
- The fifth `__` function takes `px` and `us_cities` as inputs and returns the `get_map` function, which generates the map visualization.
- The sixth `__` function takes `pd` as input and returns a DataFrame of US cities data.
- The last `__` function imports necessary libraries and returns them.

#### Internal Logic
- The `get_map` function within one of the `__` functions creates a scatter map using Plotly's `scatter_mapbox`. It configures the map style based on the `satellite` parameter, switching between a satellite view and an open-street-map view.

## References

- `marimo`: The framework used to build the application.
- `plotly.express`: Used for creating the map visualization.
- `pandas`: Used for data manipulation and reading the CSV file containing US cities data.

## Dependencies

| Dependency       | Purpose                                           |
|:-----------------|:--------------------------------------------------|
| `marimo`         | Framework for building interactive web applications. |
| `plotly.express` | Library for creating interactive plots and maps.  |
| `pandas`         | Library for data manipulation and analysis.       |

## Error Handling

The code does not explicitly handle errors beyond basic exception raising. It assumes that the data fetching and UI rendering will succeed without issues.

## Logging

The code does not implement any logging mechanisms.

## API/Interface Reference

The script does not expose an API but provides an interactive web interface through the `marimo` framework. The interface includes a switch for toggling map views and a table displaying map data.

## TODOs

There are no TODOs or notes left in the code.