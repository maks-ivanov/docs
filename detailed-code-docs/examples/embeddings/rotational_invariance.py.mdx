---
title: "rotational_invariance.py"
---

## High-level description

The target file, `rotational_invariance.py`, is a script that demonstrates the concept of rotational invariance in embeddings using the MNIST dataset. It utilizes the `marimo` library to create an interactive application where users can rotate an embedding and observe that the average distortion remains unchanged, illustrating the rotational invariance property.

## Code Structure

The code is structured as a series of cells, each defined by the `@app.cell` decorator from the `marimo` library. These cells perform various tasks such as importing necessary libraries, setting up user interface elements, computing distortions, and visualizing embeddings. The cells are executed in sequence when the application runs.

## Symbols

### `app`
#### Description
`app` is an instance of `marimo.App`, which is used to create and manage the interactive application. It is configured with a full-width layout.

### `__generated_with`
#### Description
A string indicating the version of the tool used to generate the script, set to "0.1.56".

### `@app.cell`
#### Description
A decorator provided by the `marimo` library to define a cell in the application. Each cell can contain code that performs a specific task, such as importing libraries, defining UI elements, or executing computations.

### `mo.md`
#### Description
A method from the `marimo` library used to render Markdown content in the application. It is used to display headings and formatted text.

### `mo.ui.slider`
#### Description
Creates a slider UI element that allows users to select a degree of rotation from 0 to 360 in steps of 5. This value is used to rotate the embedding.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| start | int | Starting value of the slider (0) |
| end | int | Ending value of the slider (360) |
| step | int | Increment step for the slider (5) |
| label | str | Label for the slider |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| degrees | int | The selected degree of rotation |

### `pymde.average_distortion`
#### Description
Calculates the average distortion of an embedding. It is used to demonstrate that the distortion remains constant even after rotation.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| embedding | array-like | The embedding whose distortion is to be calculated |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| E_X | float | The average distortion of the embedding |

### `pymde.rotate`
#### Description
Rotates the given embedding by a specified number of degrees.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| embedding | array-like | The embedding to be rotated |
| degrees | int | The degree of rotation |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| rotated_embedding | array-like | The rotated embedding |

### `pymde.plot`
#### Description
Plots the given embedding with specified attributes such as color, marker size, and axis limits.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| embedding | array-like | The embedding to be plotted |
| color_by | array-like | Attribute to color the points by |
| marker_size | float | Size of the markers in the plot |
| figsize_inches | tuple | Size of the figure in inches |
| axis_limits | tuple | Limits for the plot axes |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ax | matplotlib.axes.Axes | The plot axes |

### `pymde.datasets.MNIST`
#### Description
Loads the MNIST dataset, which is used as the input data for the embedding.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mnist | Dataset | The MNIST dataset |

### `pymde.laplacian_embedding`
#### Description
Computes a Laplacian embedding of the given data, which is used to demonstrate rotational invariance.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | array-like | The data to be embedded |
| verbose | bool | Whether to print progress information |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mde | Embedding | The computed Laplacian embedding |

### `mde.embed`
#### Description
Generates the embedding from the Laplacian embedding object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| verbose | bool | Whether to print progress information |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| embedding | array-like | The generated embedding |

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| `marimo` | Used for creating interactive applications and UI elements. |
| `pymde` | Used for computing and manipulating embeddings. |
| `matplotlib.pyplot` | Used for plotting the embeddings. |

## Error Handling

The code does not explicitly handle errors beyond basic exception raising. It assumes that the libraries and data are correctly set up and available.

## Logging

The code does not implement any logging mechanisms.

## API/Interface Reference

The script does not expose an API but provides an interactive interface through the `marimo` application.

## TODOs

There are no TODOs or notes left in the code.