---
title: "electric_vehicles.py"
---

## High-level description

The code in `examples/sql/electric_vehicles.py` is a script that uses the Marimo framework to create an interactive web application. This application visualizes data on electric vehicles registered in Washington State. It allows users to filter the data by model year, city, and make, and displays the results in bar charts using the Altair library.

## Code Structure

The script is structured using the Marimo framework's `@app.cell` decorator, which defines individual cells or components of the application. Each cell performs a specific task, such as loading data, creating UI elements, or rendering charts. The cells are interconnected, with some cells providing data or UI elements that are used by others.

## Symbols

### `app`
#### Description
`app` is an instance of the `marimo.App` class, which represents the web application. It is configured with a medium width and is used to define the application's cells.

### `@app.cell`
#### Description
The `@app.cell` decorator is used to define a cell in the Marimo application. Each cell is a function that performs a specific task, such as data processing or UI rendering.

### `mo`
#### Description
`mo` is an alias for the `marimo` module, which provides various utilities for building the application, such as SQL execution, UI components, and layout management.

### `evs`
#### Description
`evs` is a variable that holds the result of a SQL query that creates a table from a CSV file containing electric vehicle data. It is used as the primary dataset for the application.

### `year_select`, `city_select`, `make_select`
#### Description
These variables represent UI components that allow users to select multiple options from a list of model years, cities, and makes, respectively. They are created using Marimo's UI utilities.

### `grouped_by_city`, `grouped_by_make`
#### Description
These variables hold the results of SQL queries that group the electric vehicle data by city and make, respectively. They are used to generate bar charts that visualize the data.

### `chart1`, `chart2`
#### Description
These variables represent Altair charts that visualize the grouped data by city and make. They are displayed in the application using Marimo's UI utilities.

### `sql_list`, `as_literal`, `cast_to_ints`
#### Description
These are utility functions defined within a cell to assist with SQL query construction. `sql_list` generates SQL conditions from a list of items, `as_literal` converts values to SQL literals, and `cast_to_ints` converts a list of strings to integers.

## References

- The script references the `marimo` and `altair` libraries for building the application and creating visualizations.
- The dataset is sourced from a CSV file hosted at `https://datasets.marimo.app/gov/Electric_Vehicle_Population_Data.csv`.

## Dependencies

| Dependency | Purpose |
|:-----------|:--------|
| marimo | Used for building the interactive web application. |
| altair | Used for creating data visualizations in the form of charts. |

## Error Handling

The script does not explicitly handle errors beyond basic exception raising. It assumes that the data source is available and that the SQL queries execute successfully.

## Logging

The script does not implement any logging mechanisms.

## API/Interface Reference

The script does not expose an API. It is designed to be run as a standalone application using the Marimo framework.

## TODOs

There are no TODOs or notes left in the code.